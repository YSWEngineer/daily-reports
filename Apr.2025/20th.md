# 2025/04/20(日)
## 📚 プラクティス『Ruby中級』


## 🧩 タスクばらし
- [x] プラクティスの内容を咀嚼
- [x] タスクばらし、スモールステップの作成
- [x] 各参考ページを確認
- [ ] 参考書籍：[プロを目指す人のためのRuby入門 <改訂2版>](https://www.amazon.co.jp/dp/4297124378/)を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる


## 🐾 スモールステップ
<details><summary>プラクティスの内容を咀嚼</summary>

- [x] プラクティスの内容を咀嚼
</details>

<details><summary>タスクばらし、スモールステップの作成</summary>

- [x] タスクばらし、スモールステップの作成
</details>

<details><summary>各参考ページを確認</summary>

- [x] [学習を加速させるインデックス読書術](https://qiita.com/dkatsura/items/3364b293ed1451a66a8a)を再読
- [x] 動画：[著者自身が語る「プロを目指す人のためのRuby入門」の効果的な読み方](https://www.youtube.com/watch?v=qqqbHXarPO8)
</details>

<details><summary>参考書籍：プロを目指す人のためのRuby入門 <改訂2版>を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる</summary>

- [x] 第1章  本書を読み進める前に
   - [x] 1.1 イントロダクション
   - [x] 1.2 本書の概要
   - [x] 1.3 Ruby について
   - [x] 1.4 Ruby のインストール
   - [x] 1.5 エディタ/IDE について
   - [x] 1.6 Ruby を動かしてみる
   - [x] 1.7 本書のサンプルコードについて
   - [x] 1.8 Ruby の公式リファレンスについて
   - [x] 1.9 この章のまとめ
- [x] 第2章  Ruby の基礎を理解する
   - [x] 2.1 イントロダクション
   - [x] 2.2 Ruby に関する基礎知識
   - [x] 2.3 文字列
   - [x] 2.4 数値
   - [x] 2.5 真偽値と条件分岐
   - [x] 2.6 メソッドの定義
   - [x] 2.7 例題：FizzBuzzプログラムを作成する
   - [x] 2.8 文字列についてもっと詳しく
   - [x] 2.9 数値についてもっと詳しく
   - [x] 2.10 真偽値と条件分岐についてもっと詳しく
   - [x] 2.11 メソッド定義についてもっと詳しく
   - [x] 2.12 そのほかの基礎知識
   - [x] 2.13 この章のまとめ
- [x] 第3章  テストを自動化する
   - [x] 3.1 イントロダクション
   - [x] 3.2 Minitest の基本
   - [x] 3.3 FizzBuzzプログラムのテスト自動化
   - [x] 3.4 この章のまとめ
- [x] 第4章  配列や繰り返し処理を理解する
   - [x] 4.1 イントロダクション
   - [x] 4.2 配列
   - [x] 4.3 ブロック
   - [x] 4.4 ブロックを使う配列のメソッド
   - [x] 4.5 範囲（Range）
   - [x] 4.6 例題：RGB変換プログラムを作成する
   - [x] 4.7 配列についてもっと詳しく
   - [x] 4.8 ブロックについてもっと詳しく
   - [x] 4.9 範囲（Range）についてもっと詳しく
   - [x] 4.10 さまざまな繰り返し処理
   - [x] 4.11 繰り返し処理用の制御構造
   - [x] 4.12 この章のまとめ
- [x] 第5章  ハッシュやシンボルを理解する
   - [x] 5.1 イントロダクション
   - [x] 5.2 ハッシュ
   - [x] 5.3 シンボル
   - [x] 5.4 続・ハッシュについて
   - [x] 5.5 例題：長さの単位交換プログラムを作成する
   - [x] 5.6 ハッシュとキーワード引数についてもっと詳しく
   - [x] 5.7 シンボルについてもっと詳しく
   - [x] 5.8 この章のまとめ
- [x] 第6章  正規表現を理解する
   - [x] 6.1 イントロダクション
   - [x] 6.2 正規表現って何？
   - [x] 6.3 Ruby における正規表現オブジェクト
   - [x] 6.4 例題：Ruby のハッシュ記法を変換する
   - [x] 6.5 正規表現オブジェクトについてもっと詳しく
   - [x] 6.6 この章のまとめ
- [x] 第7章  クラスの作成を理解する
   - [x] 7.1 イントロダクション
   - [x] 7.2 オブジェクト指向プログラミングの基礎知識
   - [x] 7.3 クラスの定義
   - [x] 7.4 例題：改札機プログラムの作成
   - [x] 7.5 selfキーワード
   - [x] 7.6 クラスの継承
   - [x] 7.7 メソッドの可視性
   - [x] 7.8 定数についてもっと詳しく
   - [x] 7.9 さまざまな種類の変数
   - [x] 7.10 クラス定義や Ruby の言語使用に関する高度な話題
   - [x] 7.11 この章のまとめ
- [x] 第8章  モジュールを理解する
   - [x] 8.1 イントロダクション
   - [x] 8.2 モジュールの概要
   - [x] 8.3 モジュールを利用したメソッド定義（include と extend）
   - [x] 8.4 例題：rainbowメソッドの作成
   - [x] 8.5 モジュールを利用したメソッド定義についてもっと詳しく
   - [x] 8.6 モジュールを利用した名前空間の作成
   - [x] 8.7 関数や定数を提供するモジュールの作成
   - [x] 8.8 状態を保持するモジュールの作成
   - [x] 8.9 モジュールに関する高度な話題
   - [x] 8.10 この章のまとめ
- [x] 第9章  例外処理を理解する
   - [x] 9.1 イントロダクション
   - [x] 9.2 例外の捕捉
   - [x] 9.3 意図的に例外を発生させる
   - [x] 9.4 例外処理のベストプラクティス
   - [x] 9.5 例題：正規表現チェッカープログラムの作成
   - [x] 9.6 例外処理についてもっと詳しく
   - [x] 9.7 この章のまとめ
- [x] 第10章  yield と Proc を理解する
   - [x] 10.1 イントロダクション
   - [x] 10.2 ブロックを利用するメソッドの定義と yield
   - [x] 10.3 Procオブジェクト
   - [x] 10.4 例題：ワードシンセサイザーの作成
   - [x] 10.5 Procオブジェクトについてもっと詳しく
   - [x] 10.6 この章のまとめ
- [x] 第11章  パターンマッチを理解する
   - [x] 11.1 イントロダクション
   - [x] 11.2 パターンマッチの基本
   - [x] 11.3 パターンマッチの利用パターン
   - [x] 11.4 例題：ログフォーマッターの作成
   - [x] 11.5 パターンマッチについてもっと詳しく
   - [x] 11.6 この章のまとめ
- [ ] 第12章  Ruby のデバッグ技法を身につける
   - [x] 12.1 イントロダクション
   - [x] 12.2 バックトレースの読み方
   - [x] 12.3 よく発生する例外クラスとその原因
   - [ ] 12.4 プログラムの途中経過を確認する
   - [ ] 12.5 汎用的なトラブルシューティング方法
   - [ ] 12.6 この章のまとめ
- [ ] 第13章  Ruby に関するその他のトピック
   - [ ] 13.1 イントロダクション
   - [ ] 13.2 日付や時刻の扱い
   - [ ] 13.3 ファイルやディレクトリの扱い
   - [ ] 13.4 特定の形式のファイルを読み書きする
   - [ ] 13.5 環境変数や起動時引数の取得
   - [ ] 13.6 非推奨機能を使ったときに警告を出力する
   - [ ] 13.7 eval、バッククオートリテラル、sendメソッド
   - [ ] 13.8 Rake
   - [ ] 13.9 gem と Bundler
   - [ ] 13.10 Ruby における型情報の定義と型検査（RBS、TypeProf、Steep）
   - [ ] 13.11 「Rails の中の Ruby」と「素の Ruby」の違い
   - [ ] 13.12 この章のまとめ

</details>


---


## 🧑🏻‍💻 本日の取り組み
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
  - 第12章  Ruby のデバッグ技法を身につける
    - 12.1 イントロダクション
    - 12.2 バックトレースの読み方
    - 12.3 よく発生する例外クラスとその原因
      - NameError
      - NoMethodError
      - TypeError
      - ArgumentError
      - ZeroDivisionError
      - SystemStackError
      - LoadError
      - SyntaxError（syntax error）
      - 組み込みライブラリに定義されている上記以外の例外クラス
      - Ruby の標準ライブラリに含まれない例外クラス
      - Column：Ruby 本体や拡張ライブラリの不具合で発生する Segmentation fault


---


## 🎯 次回
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
  - 第12章  Ruby のデバッグ技法を身につける
    - 12.4 プログラムの途中経過を確認する 〜
    

---


## 💡 本日の学び・気付き
### 12.1 イントロダクション
プログラミングにエラーやバグは付きもの。ただ、熟練者であればあるほどエラーの原因を突き止め、修正するスピードが速い。反対にプログラミング初心者や Ruby を始めたばかりの他言語経験者はエラーの原因調査や修正に時間がかかる。

### 12.2 バックトレースの読み方
プログラムの実行中にエラー（例外）が発生すると、多くの場合、**バックトレース**が出力される。
#### バックトレースの前半
##### /(プログラムのパス)/lib/gate.rb:24:in`calc_fare':
この内容は大きく分けて3つのパートに分けられる。
- /(プログラムのパス)/lib/gate.rb
- 24
- in `calc_fare'

1番目は、エラーが発生したプログラムのファイルパス。
2番目の`24`は、そのファイルの 24行目。
3番目は、エラーが起きたメソッドの名前。
このバックとレースの前半は、「**gate.rb の 24行目、calc_fareメソッドの中**」という意味になる。

#### バックトレースの後半
##### undefined local variable or method `distanse' for #\<Gate:0x0000000001058d44f0\@name=:mikuni> (NameError)
undefined local variable or method `distanse' for #<Gate:0x0000000001058d44f0@name=:mikuni>  の部分はエラーの内容を説明しているエラーメッセージで、「distanse というローカル変数、もしくは Gateクラスの distanseメソッドが未定義」という意味。

#<Gate:0x0000000001058d44f0@name=:mikuni> は distanse が呼び出されたオブジェクトの情報。これは inspectメソッドを呼び出した時に得られる情報と同じ。

(NameError) は、発生したエラーの例外クラス名を表している。

バックトレースの前半と後半をまとめると、「**gate.rb の 24行目、calc_fareメソッドの中で、distanse というローカル変数、もしくは Gateクラスの distanseメソッドが未定義だった。例外クラスは NameError**」

#### 2行目
```shell
Did you mean?  distanse
```
「もしかして、使おうとしたのは distanse ですか？」という意味。Ruby ではおかしな変数名やメソッド名、クラス名などを参照しようとした場合に、プログラマがタイプミス（タイポ）した可能性を考慮して、正しい名前を提案してくれるようになっている。このときに提案される名前はエラー発生時点で呼び出し可能な変数名やメソッド名などである。

#### 3行目以降
```shell
from /(プログラムのパス)/lib/gate.rb:14:in `exit'
from lib/backtrace_sample.rb:9:in `<main>'
```
この 2行は以下の情報を表している。
- gate.rb の 14行目、exitメソッドの中
- backtrace_sample.rb の 9行目、mainオブジェクトの中

ここまでの内容をひとまとめにすると、次のような一連の情報ができあがる。
- gate.rb の 24行目、calc_fareメソッドの中
- gate.rb の 14行目、exitメソッドの中
- backtrace_sample.rb の 9行目、mainオブジェクトの中

つまり、バックトレースとは**プログラムが実行されてエラーが発生するまでのメソッド呼び出し履歴を示した情報**のこと。バックトレースは上に行くほどエラーに近く、下に行くほどエラーから遠いことを示している。そのため、一番上の行をチェックすれば、そこがエラーの発生した場所である。

下に行くほど古い呼び出しになるので、順番をひっくり返してみると......
- backtrace_sample.rb の 9行目が呼ばれた。
- gate.rb の 14行目（exitメソッド内のコード）が呼ばれた。
- gate.rb の 24行目（calc_fareメソッド内のコード）が呼ばれた。そこでエラーが起きた。

大事なことはエラー発生時のバックトレースをしっかりと読み解けること。バックトレースを読める人はエラーを早く解決できる。一人前の Rubyプログラマを目指すなら、バックトレースを読み解けるようになること。

### 12.3 よく発生する例外クラスとその原因
#### NameError
**未定義のローカル変数や定数などを呼び出した時**に発生する。単純なタイプミスであることが多いが、外部ファイルや外部ライブラリの`require`を忘れている場合にも発生することもある。

#### NoMethodError
存在しないメソッドや可視性が制限されているため呼び出せないメソッドを呼び出そうとした場合に発生する。たとえば以下のような原因が考えられる。
- **単純にメソッド名を打ち間違えた。**
- **privateメソッドをクラスの外部から呼び出そうとした。**
- **レシーバの型（クラス）が想定していた型と異なる（文字列ではなくシンボルになっていいた場合など）。**
- **レシーバが想定に反して`nil`になっている。**

特に4つめのレシーバが`nil`になっているケースは非常によく発生する。本来`nil`になるべきでない変数が`nil`になっている場合に発生するのはもちろん、インスタンス変数のタイプミスでも容易に同じ問題が発生する。

#### TypeError
TypeError は期待しない型（クラス）がメソッドの引数に渡された時に発生する。

#### ArgumentError
ArgumentError は引数（argument）の数が違かったり、期待する値ではなかったりした場合に発生する。

#### ZeroDivisionError
ZeroDivisionError は整数を`0`で除算（割り算）しようとした時に発生する。

#### SystemStackError
スタックが溢れた時に発生する。特に間違ってメソッドを再帰呼び出した場合に発生する。

スタックとはメソッドが呼ばれるたびに積み上げられていくメモリ領域のこと。スタックはメソッドの呼び出しが終わらないと解放されないため、積み上げすぎると領域が溢れてエラーが発生する。

#### LoadError
`require`や`require_relative`の実行に失敗した時に発生する。たとえば以下のような原因が考えられる。
- **require の引数に与えたライブラリ名が間違っている。**
- **require しようとした gem が実行環境にインストールされていない。**
- **require_relative で指定したファイルのパスが間違っている。**

#### SyntaxError（syntax error）
構文エラーのこと。大抵の場合、プログラムの起動自体に失敗する。このエラーが発生したときは`end`やカンマの数に過不足がある、丸括弧や中括弧が閉じられていない、といった原因が考えられる。

#### Column：Ruby 本体や拡張ライブラリの不具合で発生する Segmentation fault
Segmentation fault（セグメンテーションフォルト、セグフォ、SEGVとも）は特殊なエラーである。このエラーは Ruby本体や拡張ライブラリに何らかの不具合があるときに発生する。表示されるエラーメッセージも大量で、表示形式も通常の例外とは全く異なる。

Ruby 本体や拡張ライブラリの内部実装に精通していない限り、このエラーを自力で解決するのは難しい。ただし、最新版の Ruby やライブラリ（gem）を使えば問題が解消する可能性もあるので、古いバージョンを使用している場合は最新版にアップデートして再度実行してみること。それでも解決しない場合は Ruby 本体やライブラリの issueトラッキングシステムにセグフォの発生を報告して修正を待つこと。


---


## ✍🏻 感想
### 🍒 エラーメッセージの読み方とエラーの型を再確認
今回はエラーメッセージの読み解き方や、さまざまなエラーの型について学びました。プラクティス『プログラムの修正』にありました必読書『コードが動かないので帰れません！ 新人プログラマーのためのエラーが怖くなくなる本』この本の内容を思い出しながら取り組むことで、理解がグッと深まりました。

エラーは、ちゃんと向き合えば怖くない。英文のメッセージも自分の言葉に置き換えて読み解いていけば、きっと大丈夫......多分（実践が乏しいのでまだ自信がありません）😅

---


### ⏰ 学習時2
- Today:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 hours 09 min
- Total: 1053 hours 38 min
