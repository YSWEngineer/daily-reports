# 2025/08/13(水)
## 📚 プラクティス『lsコマンドを作る1』

<details><summary>🎯 学習の狙い</summary>

- 標準出力について学ぶ
- 標準ライブラリの使い方を学ぶ
- Enumeratorには、each以外に便利なメソッドがあることを学ぶ
- RailsじゃないRubyプログラミングを学ぶ
- メソッド分割を学ぶ
- わかりやすい変数名メソッド名を学ぶ
- 大きな問題を分割する力を学ぶ
</details>


<details><summary>📌 要件</summary>

- [ ] オプション（`-a`や`-r`など）を付けず、且つ引数（フォルダのパス）も指定せずに実行する
- [ ] そのまま実行すると、今いるフォルダ（カレントディレクトリ）の中身を表示する
- [ ] `gem`は使わずに Ruby の標準ライブラリだけで作ること
- [ ] 完成したコードは GitHub の Pull Request として提出すること
- [ ] `rubocop-fjord`でデバッグを実行し、全てパスさせること
- [ ] 2つ以上のメソッドを自分で定義すること
- [ ] 表示は横に最大3列になるようにレイアウトすること
  - 3, 6, 9, 12のように3の倍数の件数だけでなく、最後の列に空欄ができるケースの結果も載せる
  - 「3列から5列に仕様変更してください」または「3列から100列に変えてください」とあとから言われても必要最小限の変更で対応できるようなロジックにしておくこと

</details>

<details><summary>📚 参考資料</summary>

<details><summary>参考</summary>

  - [x] [lsコマンドを作る](https://bootcamp.fjord.jp/pages/380)
</details>
 

<details><summary>学習の狙い</summary>

  - [x] [【lsコマンド】大きな問題を小さく分解してから取り組む](https://bootcamp.fjord.jp/pages/279)
</details>

<details><summary>ヒント</summary>

  - [x] [lsコマンドの使い方と覚えたい15のオプション【Linuxコマンド集】](https://eng-entrance.com/linux_command_ls)
  - [x] [library optparse (Ruby 2.6.0)](https://docs.ruby-lang.org/ja/latest/library/optparse.html)
  - [x] [コマンドライン引数によるオプションに対応する (optparse) | まくまくRubyノート](https://maku77.github.io/ruby/io/optparse.html)
  - [x] [コマンドライン引数・オプションの処理](https://bootcamp.fjord.jp/pages/251)
  - [x] [binding.irb](https://docs.ruby-lang.org/ja/latest/method/Kernel/m/binding.html)
  - [x] [Fileクラス](https://docs.ruby-lang.org/ja/latest/class/File.html)
  - [x] [lsコマンドで表示されるファイルのモード(drwxr-xr-x) 〜RubyのFile::Stat#modeとは〜](https://zenn.dev/universato/articles/20201202-z-mode)
</details>

<details><summary>良いプログラムを書くための方法</summary>

  - [ ] [プログラミング初心者は変数名やメソッド名を略さない方がいいよ、という話 - give IT a try](https://blog.jnito.com/entry/2020/10/20/092724)
  - [ ] [\[RubyTips\] ハッシュテーブルによる分岐数削減](https://docs.komagata.org/5691)
  - [ ] [プログラムを書くときの考え方](https://bootcamp.fjord.jp/pages/147)
  - [ ] [rubyでコマンドを作る](https://bootcamp.fjord.jp/pages/250)
  - [ ] [RubyTips - komagataのブログ](https://docs.komagata.org/tags/rubytips/)
  - [ ] [Rubyスクリプトにもmainメソッドを定義するといいかも、という話 - Qiita](https://qiita.com/jnchito/items/4b4cae54170cc2f4377e)
  - [ ] [初心者がRailsプロジェクトへの初PRする前に見るチェックリスト - komagataのブログ](https://docs.komagata.org/5676)
  - [ ] [プログラミングでよく使う英単語のまとめ【随時更新】 - Qiita](https://qiita.com/Ted-HM/items/7dde25dcffae4cdc7923)
  - [ ] [代表的なデータ構造](https://bootcamp.fjord.jp/pages/148)
  - [ ] [配列の二人三脚を避ける](https://bootcamp.fjord.jp/pages/388)
  - [ ] [参考：lsコマンドの列幅が人によって異なるのはなぜ？ | FBC
](https://bootcamp.fjord.jp/questions/707)
</details>

 <details><summary>終了条件の確認</summary>

- [x] [終了条件 - lsコマンドを作る](https://bootcamp.fjord.jp/pages/ls-command#requirements)
</details>
</details>


---


### 🧑🏻‍💻 本日の取り組み
#### プラクティス『lsコマンドを作る1』🛠️💻
- [コマンドライン引数・オプションの処理](https://bootcamp.fjord.jp/pages/251)
- [引数とオプションについて詳しく、オプションとは、オプションのガイドライン、マニュアルで使い方を知る - Fjord, Inc(株式会社フィヨルド)
](https://fjord.jp/kuroigamen/4.html)
- [module function Kernel.#binding](https://docs.ruby-lang.org/ja/latest/method/Kernel/m/binding.html)
- [class File](https://docs.ruby-lang.org/ja/latest/class/File.html)
- [lsコマンドで表示されるファイルのモード(drwxr-xr-x) 〜RubyのFile::Stat#modeとは〜](https://zenn.dev/universato/articles/20201202-z-mode)


---


### ⏭️ 次回
#### プラクティス『lsコマンドを作る1』🛠️💻
- [プログラミング初心者は変数名やメソッド名を略さない方がいいよ、という話 - give IT a try](https://blog.jnito.com/entry/2020/10/20/092724)


---


### 💡 本日の学び・気付き
#### 引数とオプションについて詳しく、オプションとは、オプションのガイドライン、マニュアルで使い方を知る
##### 引数とオプションについて詳しく
引数はコマンドに渡す文字列。コマンドの後にスペースを一個入れて文字を打ち込む。
```shell
$ echo hello
```
引数は複数渡すことができる。
```shell
$ echo hello my friend
hello my friend
```
引数をどう処理するのかはコマンドによって違う。

##### オプションのガイドライン
`-`（ハイフン）のあとアルファベット一文字がオプション。オプションは複数指定できる。
```shell
$ command -a -b -c foo
```
オプションに文字を渡すことができるものがある。（ファイルを指定する`-f`オプションがあった場合）
```shell
$ command -f /tmp/foo
```
`--`（ハイフン）2つから始まる同じ機能を持つオプションがある場合がある。ハイフン一つのものを**ショートネームオプション**（short name option）、ハイフン二つのものを**ロングネームオプション**（long name option）と呼ぶ。
```shell
$ command --name
```
ロングネームオプションに文字を渡すことができるものがある。ロングネームオプション2文字を渡す場合は`=`（イコール）を付ける。下記の2行は同じ動作をする。
```shell
$ command -f /tmp/foo
$ command --file=/tmp/foo
```
ショートネームオプションとロングネームオプションは混在させることができる。
```shell
$ command -a --file=/tmp/foo bar
```
`-h`または`--help`でそのコマンドの使い方が表示される。`Usage`は利用法という意味。
```shell
$ command --help
  Usage: command [options] [arguments]
    -a    append mode
    -f    target file
```
`-v`または`--version`でそのコマンドのバージョン番号が表示される。
```shell
$ command --version
command 1.2.3
```


---
#### コマンドライン引数・オプションの処理
##### rubyでコマンドライン引数の処理の仕方
ruby で何かやりたいことがある場合はまず組み込みライブラリ・標準添付ライブラリに使えるものがないか探す。一通り目を通してどんなものがあるのか頭に入れておく。

例：「xmlだったらそういうライブラリが標準添付ライブラリにあった気がするぞ。」

##### 引数の処理
```ruby
#!/usr/bin/env ruby
  
puts ARGV[0]
```
```shell
% ./arg.rb foo
foo
```
`optparse`を使わなくても引数は定数`ARGV`から取れる。
- `#!/usr/bin/env ruby`：これは`shebang`（シバン）。「このファイルを実行する時は ruby で動かすこと」という指示。
  - `shebang`：Terminal などの黒い画面で実行しようとしたファイルの一行目の最初の二文字が`#!`なら、その後に書いてあるコマンドに二行目以降の全てを渡す、という機能。　**※ [作業の自動化、謎のおまじないshebang（シバン）、PATHを設定する](https://fjord.jp/kuroigamen/8.html) 参照**
- `ARGV`：コマンドが実行された時に渡された引数が順番に入る。
- `ARGV[0]`：`ARGV`の最初の要素を意味する。引数は配列なので、`[0]`は最初の引数を取り出す。
- `puts ARGV[0]`：最初の引数を出力する。
- `./arg.rb`：カレントディレクトリにある`arg.rb`という Rubyスクリプトを実行。
- `foo`：これが引数として渡される。

##### ショートネームオプションの処理
```ruby
#!/usr/bin/env ruby
require 'optparse'

options = ARGV.getopts('a')
puts options
```
```shell
% ./arg.rb -a 
{"a"=>true}
```
`ARGV.getopts`で取れる。
- `#!/usr/bin/env ruby`：これは`shebang`（シバン）。先程と同じ。
- `require 'optparse`：`ARGV.getopts`が使えるようになる。
- `ARGV.getopts('a')`：「`-a`オプションを認識する」という定義。返り値は**ハッシュ**（「鍵（key）」と「値（value）」をセットで覚えておく箱のようなもの）で、`-a`があれば`{"a"=>true}`、`-a`がなければ`{"a"=>false}`を返す。

##### 引数付きショートネームオプションの処理
```ruby
#!/usr/bin/env ruby
require 'optparse'

options = ARGV.getopts('a:')
puts options
```
```shell
% ./arg.rb -a 111
{"a"=>"111"}
```
1. `require 'optparse'`で`optparse`を読み込む。
2. `ARGV.getopts('a:')`は「`-a`というショートオプションを認識する。`:`が後ろに付いているので値（引数）を受け取る」といった内容。
3. コマンド実行時に`-a 111`を渡すと、`getopts`は`-a`の次にある`111`をその値（引数）として受け取り、戻り値としてハッシュ`{"a"=>"111"}`を返す。`""`で囲んであるので文字列として入っている。

##### ロングネームオプションの処理
```ruby
#!/usr/bin/env ruby
require 'optparse'

options = ARGV.getopts('', 'foo')
puts options
```
```shell
% ./arg.rb --foo
{"foo"=>true}
```
- `''`：ここにはショートオプションの指定を書く場所だが、今回は無いので**空文字**。
- `'foo'`：ここにはロングオプション`--foo`を指定。

##### 引数付きロングネームオプションの処理
```ruby
#!/usr/bin/env ruby
require 'optparse'

options = ARGV.getopts('', 'foo:')
puts options
```
```shell
% ./arg.rb --foo 222
{"foo"=>"222"}
```
処理の流れは、引数付きショートネームオプションの処理と同じ。

##### 色々オプションの処理
```ruby
#!/usr/bin/env ruby
require 'optparse'

options = ARGV.getopts('ab:', 'bar', 'buz:')
puts options
```
```shell
% ./arg.rb -a -b 1 --bar --buz 333
{"a"=>true, "b"=>"1", "bar"=>true, "buz"=>"333"}
```
- `options = ARGV.getopts('ab:', 'bar', 'buz:')`：`getopts`はオプションを定義するためのメソッド。
  - 最初の引数`'ab:'`はショートオプションの定義
    - `'a'` → `-a`：値（引数）がない。
    - `'b:'` → '-b`：値（引数）を受け取る。
  - `'bar'`や`'buz:'`はロングオプションの定義
    - `'bar'` → `--bar`：値（引数）がない。
    - `'buz:'` → `--buz`：値（引数）を受け取る。
  - `getopts`は**ハッシュ**で返す（キーは文字列）。
    - 値（引数）がなければ`true`か`false`を返す。
    - 値（引数）が付くオプションは文字列を返す。


---


### ✍🏻 感想
#### 🏋🏻 復習とインプット
本日も参考資料を読み復習と新しい知識のインプットを行いました。特筆すべきことはありませんが、コツコツと学びを積み重ねています。


---


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 hours 19 min
- Total: 1233 hours 03 min
