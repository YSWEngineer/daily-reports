# 2025/12/15(月)
## 📚 プラクティス『🛠️💻 lsコマンドを作る2』

<details><summary>🎯 学習の狙い</summary>

- 標準出力について学ぶ
- 標準ライブラリの使い方を学ぶ
- Enumeratorには、each以外に便利なメソッドがあることを学ぶ
- RailsじゃないRubyプログラミングを学ぶ
- メソッド分割を学ぶ
- わかりやすい変数名メソッド名を学ぶ
- 大きな問題を分割する力を学ぶ
</details>

<details><summary>📌 要件（Docs：lsコマンドを作る 参照）</summary>

- [ ] `-a`オプションを付けたとき、`.`で始まる隠しファイルも表示対象にする
- [ ] ⚠️ 注意事項：`..`は表示されなくてもよい
- [ ] そのまま実行すると、今いるフォルダ（カレントディレクトリ）の中身を表示する
- [ ] `gem`は使わずに Ruby の標準ライブラリだけで作ること
- [ ] 完成したコードは GitHub の Pull Request として提出すること
- [ ] `rubocop-fjord`でデバッグを実行し、全てパスさせること
- [ ] 表示は横に最大3列になるようにレイアウトすること
  - 3, 6, 9, 12のように3の倍数の件数だけでなく、最後の列に空欄ができるケースの結果も載せる
  - 「3列から5列に仕様変更してください」または「3列から100列に変えてください」とあとから言われても必要最小限の変更で対応できるようなロジックにしておくこと
</details>

<details><summary>📍 処理の流れ ※ 随時、追加・変更あり</summary>

**1. オプションの有無を判定**

**2. ファイル一覧取得**

**3. 出力するファイルを選別（隠しファイルを含む or 含まない）**

**4. 表示するための整形**

**5. 1 〜 4 を踏まえた上での出力**
</details>

<details><summary> 🧩 タスクばらし ※ 随時、追加・変更あり</summary>

- [ ] タスク1：前提の整理
  - [ ] `ls`コマンド、`-a`オプションについて確認

- [ ] タスク2：`-a`オプションを受け取れる状態にする
  - [ ] `ARGV`を使用して引数を確認する
  - [ ] `-a`オプションを含む処理 / 含まない処理を分けて考える（条件分岐🤔）

- [ ] タスク3：ディレクトリの中身を取得

- [ ] タスク4：隠しファイルの扱いを決める
  - [ ] `-a`オプションが付いているなら`.`から始まるファイルを表示させる
  - [ ] `-a`オプションが付いていないなら隠しファイルは表示させない

- [ ] タスク5：レイアウトの調整
  - [ ] 『lsコマンドを作る1』で作成したレイアウトの処理をそのまま使用🤔
  - [ ] `-a`オプションを使ったときに隠しファイルが表示されるようにする

- [ ] タスク6：rubocop-fjord に通す

- [ ] タスク7：提出
  - [ ] 作成した lsコマンドを Pull Request として提出
  - [ ] 提出物にlsコマンドの実行結果とOS標準（macなど自分の使ってるOS）のlsコマンドをのスクリーンショットを併記して貼る
  - [ ] rubocop-fjord のチェックが全てパスした画面をスクショして添付
</details>


---


## 🧑🏻‍💻 本日の取り組み
### 📚 プラクティス『🛠️💻 lsコマンドを作る2』 
- `ls`コマンド、`-a`オプション、`ARGV`などについて参考URLやテキストで確認
  - [lsコマンドの使い方と覚えたい15のオプション【Linuxコマンド集】](https://eng-entrance.com/linux_command_ls)
  - [library optparse (Ruby 2.6.0)](https://docs.ruby-lang.org/ja/latest/library/optparse.html)



---


## ⏭️ 次回
### 📚 プラクティス『🛠️💻 lsコマンドを作る2』
- `ls`コマンド、`-a`オプション、`ARGV`などについて参考URLやテキストで確認
  - [コマンドライン引数によるオプションに対応する (optparse) | まくまくRubyノート](https://maku77.github.io/ruby/io/optparse.html)
  - [コマンドライン引数・オプションの処理](https://bootcamp.fjord.jp/pages/251)


---


### 💡 本日の学び・気付き
#### -aオプションとは？
- `-a`オプションを使うと、ファイル名の先頭に`.`（ピリオド）があるファイルも表示する。
- ファイル名の先頭に`.`（ピリオド）があるファイルは Linux のシステムと結びつき、普段簡単には編集されたくない設定ファイルのようなものが多い。
- 大文字の`-A`オプションを使うと`.`（カレントディレクトリ）と`..`（一つ上のディレクトリ）を除いた形で表示される。

#### library optparse
- `optparse`とは、コマンドラインのオプションを取り扱うためのライブラリ。
- `optparse`を使う場合の基本的な流れ
  - ① OptionParserオブジェクト`opt`を生成する。
  - ② オプションを取り扱うブロックを`opt`に登録する。
  - ③ `opt.parse(ARGV)`でコマンドラインに実際に`parse`する。

#### オプションの定義
オプション`-a`, `-b`を受け付けるコマンドを作成する例。
```ruby
require 'optparse'
opt = OptionParser.new

opt.on('-a') {|v| p v }
opt.on('-b') {|v| p v }

opt.parse!(ARGV)
p ARGV
```
```shell
% ruby sample.rb -a foo bar -b baz
true
true
["foo", "bar", "baz"]
```
```ruby
require 'optparse'
```
- OptionParser というライブラリを使えるようにする、という宣言。
- `optparse`は`-a`や`-r`といったコマンドラインオプションを解析・管理するためのライブラリ。

```ruby
opt = OptionParser.new
```
- `OptionParser.new` → `OptionParser`クラスのインスタンスを作成。
- `opt` → 「どんなオプションがあるか」「それをどう処理するか」を管理する役割。
- つまり「このプログラムには、こういうオプションがありますよ」と登録するための箱。

```ruby
opt.on('-a') {|v| p v }
```
- `-a`オプションを登録。
- `-a`オプションが指定されたとき、ブロック`{|v| p v }`が実行される。
- `{|v| p v }`
  - `v`には、そのオプションが指定されたかどうかが入る。
  - 今回は`-a`なので、指定されると`v`は`true`を返す。
  - `p v`は、その値を画面に表示。

```ruby
opt.on('-b') {|v| p v }
```
- `-b`オプションを登録。
- 上記の`-a`と全く同じ仕組み。
- 実行時に`-b`が指定されると`true`を返す。

```ruby
opt.parse!(ARGV)
```
- `ARGV`は、コマンドライン引数が入っている配列。

```ruby
ruby sample.rb -a foo bar -b baz
```
##### 実行の流れ
1. `-a`を発見
→ `opt.on('-a')`のブロックが実行。
→ `true`が表示。
2. `-b`を発見
→ `opt.on('-b')`のブロックが実行。
→ `true`が表示。
3. 残った引数は、
→ 配列で表示`["foo", "bar", "baz"]`

##### 出力結果の意味
```text
true  #=> -aオプションが指定された
true  #=> -bオプションが指定された
["foo", "bar", "baz"]  # オプション以外の引数
```

### lsコマンドと-aオプションの関係を考えてみる
上記の内容の仕組みを改めて`ls -a`という形に当てはめると......
- `opt.on('-a')`
→ 「隠しファイルを表示するかどうか」を判定。
- `ARGV`
→ 表示対象のディレクトリ（今回はカレントディレクトリ）

つまり、
> オプション（どう表示させるのか）と
引数（何を表示させるのか）を分離して扱うことができる

これが`OptionParser`を使用するメリットではないか？と考える🤔

まとめると......

|コード   |役割   |
|---|---|
|require 'optparse'   |オプション解析機能を読み込む   |
|OptionParser.new   |オプション管理オブジェクト作成   |
|opt.on('-a')   |-aオプションを定義   |
|opt.parse!(ARGV)   |オプション解析   |
|p ARGV   |残った引数を確認   |


---


## ✍🏻 感想
久し振りの学習です。本日は、`ls`コマンドの`-a`オプションを題材に、OpitonParser の仕組みを丁寧に整理しました。オプションと引数を分離して扱う点に着目し、「どう表示させるのか」と「何を表示させるのか」を切り分けて考えることで`ls -a`の挙動がなんとなくイメージできたような気がします。

引き続き、参考URLを確認して処理の流れを言語化しながら理解を積み重ねていきたいです。


---


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 hours 36 min
- Total: 1439 hours 36 min
