# 2025/02/28(金)
## 📚 プラクティス『Ruby中級』


## 🧩 タスクばらし
- [x] プラクティスの内容を咀嚼
- [x] タスクばらし、スモールステップの作成
- [x] 各参考ページを確認
- [ ] 参考書籍：[プロを目指す人のためのRuby入門 <改訂2版>](https://www.amazon.co.jp/dp/4297124378/)を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる


## 🐾 スモールステップ
<details><summary>プラクティスの内容を咀嚼</summary>

- [x] プラクティスの内容を咀嚼
</details>

<details><summary>タスクばらし、スモールステップの作成</summary>

- [x] タスクばらし、スモールステップの作成
</details>

<details><summary>各参考ページを確認</summary>

- [x] [学習を加速させるインデックス読書術](https://qiita.com/dkatsura/items/3364b293ed1451a66a8a)を再読
- [x] 動画：[著者自身が語る「プロを目指す人のためのRuby入門」の効果的な読み方](https://www.youtube.com/watch?v=qqqbHXarPO8)
</details>

<details><summary>参考書籍：プロを目指す人のためのRuby入門 <改訂2版>を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる</summary>

- [x] 第1章  本書を読み進める前に
   - [x] 1.1 イントロダクション
   - [x] 1.2 本書の概要
   - [x] 1.3 Ruby について
   - [x] 1.4 Ruby のインストール
   - [x] 1.5 エディタ/IDE について
   - [x] 1.6 Ruby を動かしてみる
   - [x] 1.7 本書のサンプルコードについて
   - [x] 1.8 Ruby の公式リファレンスについて
   - [x] 1.9 この章のまとめ
- [x] 第2章  Ruby の基礎を理解する
   - [x] 2.1 イントロダクション
   - [x] 2.2 Ruby に関する基礎知識
   - [x] 2.3 文字列
   - [x] 2.4 数値
   - [x] 2.5 真偽値と条件分岐
   - [x] 2.6 メソッドの定義
   - [x] 2.7 例題：FizzBuzzプログラムを作成する
   - [x] 2.8 文字列についてもっと詳しく
   - [x] 2.9 数値についてもっと詳しく
   - [x] 2.10 真偽値と条件分岐についてもっと詳しく
   - [x] 2.11 メソッド定義についてもっと詳しく
   - [x] 2.12 そのほかの基礎知識
   - [x] 2.13 この章のまとめ
- [x] 第3章  テストを自動化する
   - [x] 3.1 イントロダクション
   - [x] 3.2 Minitest の基本
   - [x] 3.3 FizzBuzzプログラムのテスト自動化
   - [x] 3.4 この章のまとめ
- [x] 第4章  配列や繰り返し処理を理解する
   - [x] 4.1 イントロダクション
   - [x] 4.2 配列
   - [x] 4.3 ブロック
   - [x] 4.4 ブロックを使う配列のメソッド
   - [x] 4.5 範囲（Range）
   - [x] 4.6 例題：RGB変換プログラムを作成する
   - [x] 4.7 配列についてもっと詳しく
   - [x] 4.8 ブロックについてもっと詳しく
   - [x] 4.9 範囲（Range）についてもっと詳しく
   - [x] 4.10 さまざまな繰り返し処理
   - [x] 4.11 繰り返し処理用の制御構造
   - [x] 4.12 この章のまとめ
- [x] 第5章  ハッシュやシンボルを理解する
   - [x] 5.1 イントロダクション
   - [x] 5.2 ハッシュ
   - [x] 5.3 シンボル
   - [x] 5.4 続・ハッシュについて
   - [x] 5.5 例題：長さの単位交換プログラムを作成する
   - [x] 5.6 ハッシュとキーワード引数についてもっと詳しく
   - [x] 5.7 シンボルについてもっと詳しく
   - [x] 5.8 この章のまとめ
- [x] 第6章  正規表現を理解する
   - [x] 6.1 イントロダクション
   - [x] 6.2 正規表現って何？
   - [x] 6.3 Ruby における正規表現オブジェクト
   - [x] 6.4 例題：Ruby のハッシュ記法を変換する
   - [x] 6.5 正規表現オブジェクトについてもっと詳しく
   - [x] 6.6 この章のまとめ
- [x] 第7章  クラスの作成を理解する
   - [x] 7.1 イントロダクション
   - [x] 7.2 オブジェクト指向プログラミングの基礎知識
   - [x] 7.3 クラスの定義
   - [x] 7.4 例題：改札機プログラムの作成
   - [x] 7.5 selfキーワード
   - [x] 7.6 クラスの継承
   - [x] 7.7 メソッドの可視性
   - [x] 7.8 定数についてもっと詳しく
   - [x] 7.9 さまざまな種類の変数
   - [x] 7.10 クラス定義や Ruby の言語使用に関する高度な話題
   - [x] 7.11 この章のまとめ
- [ ] 第8章  モジュールを理解する
   - [x] 8.1 イントロダクション
   - [x] 8.2 モジュールの概要
   - [x] 8.3 モジュールを利用したメソッド定義（include と extend）
   - [x] 8.4 例題：rainbowメソッドの作成
   - [ ] 8.5 モジュールを利用したメソッド定義についてもっと詳しく
   - [ ] 8.6 モジュールを利用した名前空間の作成
   - [ ] 8.7 関数や定数を提供するモジュールの作成
   - [ ] 8.8 状態を保持するモジュールの作成
   - [ ] 8.9 モジュールに関する高度な話題
   - [ ] 8.10 この章のまとめ
- [ ] 第9章  例外処理を理解する
   - [ ] 9.1 イントロダクション
   - [ ] 9.2 例外の捕捉
   - [ ] 9.3 意図的に例外を発生させる
   - [ ] 9.4 例外処理のベストプラクティス
   - [ ] 9.5 例題：正規表現チェッカープログラムの作成
   - [ ] 9.6 例外処理についてもっと詳しく
   - [ ] 9.7 この章のまとめ
- [ ] 第10章  yield と Proc を理解する
   - [ ] 10.1 イントロダクション
   - [ ] 10.2 ブロックを利用するメソッドの定義と yield
   - [ ] 10.3 Procオブジェクト
   - [ ] 10.4 例題：ワードシンセサイザーの作成
   - [ ] 10.5 Procオブジェクトについてもっと詳しく
   - [ ] 10.6 この章のまとめ
- [ ] 第11章  パターンマッチを理解する
   - [ ] 11.1 イントロダクション
   - [ ] 11.2 パターンマッチの基本
   - [ ] 11.3 パターンマッチの利用パターン
   - [ ] 11.4 例題：ログフォーマッターの作成
   - [ ] 11.5 パターンマッチについてもっと詳しく
   - [ ] 11.6 この章のまとめ
- [ ] 第12章  Ruby のデバッグ技法を身につける
   - [ ] 12.1 イントロダクション
   - [ ] 12.2 バックトレースの読み方
   - [ ] 12.3 よく発生する例外クラスとその原因
   - [ ] 12.4 プログラムの途中経過を確認する
   - [ ] 12.5 汎用的なトラブルシューティング方法
   - [ ] 12.6 この章のまとめ
- [ ] 第13章  Ruby に関するその他のトピック
   - [ ] 13.1 イントロダクション
   - [ ] 13.2 日付や時刻の扱い
   - [ ] 13.3 ファイルやディレクトリの扱い
   - [ ] 13.4 特定の形式のファイルを読み書きする
   - [ ] 13.5 環境変数や起動時引数の取得
   - [ ] 13.6 非推奨機能を使ったときに警告を出力する
   - [ ] 13.7 eval、バッククオートリテラル、sendメソッド
   - [ ] 13.8 Rake
   - [ ] 13.9 gem と Bundler
   - [ ] 13.10 Ruby における型情報の定義と型検査（RBS、TypeProf、Steep）
   - [ ] 13.11 「Rails の中の Ruby」と「素の Ruby」の違い
   - [ ] 13.12 この章のまとめ

</details>


------------


## 🧑🏻‍💻 本日の取り組み
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
  - 第8章  モジュールを理解する   
    - 8.4 例題：rainbowメソッドの作成 途中から
      - rainbowメソッドのリファクタリング
      - あらゆるオブジェクトでrainbowメソッドを使えるようにする
    - 8.5 モジュールを利用したメソッド定義についてもっと詳しく
      - includeされたモジュールの有無を確認する
      - Enumerableモジュール
      - Comparableモジュールと<=>演算子
    

## 🎯 次回
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
  - 第8章  モジュールを理解する
    - 8.5 モジュールを利用したメソッド定義についてもっと詳しく 途中から
      - Kernelモジュール


------------


## 💡 本日の学び・気付き
### 8.4 例題：rainbowメソッドの作成
####  rainbowメソッドリファクタリング
実装した rainbowメソッドにはリファクタリングの余地がある。
- **self.to_s の self. を省略する。**
- **to_s の結果を変数 str に代入せず、直接 each_charメソッドを呼ぶ。**
- **ループカウンタ count の値を自分で加算していくのではなく、with_index を利用して取得する。**
- **join した結果を変数ret に入れず、join の戻り値に対して直接"\e{0m"を連結する。**

以上を適用すると、次のようにリファクタリングできる。
```ruby
module Rainbowable
  def rainbow
    colored_chars = []
    to_s.each_char.with_index do |char, count|
      color = 31 + count % 6
      colored_chars << "\e[#{color}m#{char}"
    end
    colored_chars.join + "\e[0m"
  end
end
```
さらにリファクタリングを続ける。まず、「空の配列を用意して、他の配列をループ処理した結果を空の配列に詰め込んでいくような処理」は mapメソッドに置き換えることができる。ここでは変数 colored_chars に対する処理がそれに該当する。ただし、with_index でループカウンタの値も取得しなければならないため、each_char.map.with_index というように書き換える。加えて、mapメソッドの戻り値に対して直接 joinメソッドを呼び出す。これらの知識を総合して、以下のリファクタリングが可能となる。
```ruby
module Rainbowable
  def rainbow
    to_s.each_char.map.with_index do |char, count|
      color = 31 + count % 6
      "\e[#{color}m#{char}"
    end.join + "\e[0m"
  end
end
```
テストがパスすることを確認。
```shell
~/ruby-book % ruby test/rainbowable_test.rb
Run options: --seed 25030

# Running:

.

Finished in 0.000971s, 1029.8659 runs/s, 2059.7319 assertions/s.

1 runs, 2 assertions, 0 failures, 0 errors, 0 skips
```

#### あらゆるオブジェクトで rainbowメソッドを使えるようにする
Ruby のクラスは全て Objectクラスを継承している。先ほどのテストコードでは Stringクラスと Arrayクラスにだけ Rainbowableモジュールを`include`したが、Objectクラスに`include`すれば Hashオブジェクトや範囲オブジェクトなど、あらゆるオブジェクトで rainbowメソッドが使えるようになる。

rainbowable_test.rb の setupメソッドを次のように書き換えてみる。
```ruby
def setup
  # StringクラスやArrayクラスではなく、ObjectクラスにRainbowableモジュールをincludeする
  Object.include Rainbowable
end
```
setupメソッドを書き換えたら、test_rainbowメソッド内で任意のオブジェクトに対して rainbowメソッドを呼び出すようにする。
```ruby
def test_rainbow
  expected = "\e[31mH\e[32me\e[33ml\e[34ml\e[35mo\e[36m,\e[31m \e[32mw\e[33mo\e[34mr\e[35ml\e[36md\e[31m!\e[0m"
  assert_equal expected, 'Hello, world!'.rainbow

  expected = "\e[31m[\e[32m1\e[33m,\e[34m \e[35m2\e[36m,\e[31m \e[32m3\e[33m]\e[0m"
  assert_equal expected, [1, 2, 3].rainbow

  # ハッシュや範囲オブジェクトなど、任意のオブジェクトに対してrainbowメソッドを呼び出してみる
  puts({foo: 123, bar: 456}.rainbow)
  puts (10..20).rainbow
  puts true.rainbow
  puts false.rainbow
end
```
テストを実行すると各オブジェクトの内容がカラフルにターミナル上に出力される。

<a href="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBLzNXQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--f9ea35414bece3a50a3b0b6fe47a77d599a54e97/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202025-02-28%2018.40.48.png" target="_blank" rel="noopener noreferrer"><img src="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBLzNXQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--f9ea35414bece3a50a3b0b6fe47a77d599a54e97/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202025-02-28%2018.40.48.png" width="988" height="452" alt="スクリーンショット 2025-02-28 18.40.48.png"></a>

Objectクラスにモジュールを`include`すれば、あらゆるオブジェクトで同じメソッドが呼び出せるようになる。

### 8.5 モジュールを利用したメソッド定義についてもっと詳しく
#### include されたモジュールの有無を確認する
あるクラスに特定のモジュールが`include`されているかどうか確認する方法はいくつかある。たとえば、Productクラスが Loggableモジュールを`include`していたとする。
```ruby
module Loggable
  # 省略
end

class Product
  include Loggable
  # 省略
end
```
クラスオブジェクトに対して`include?`メソッドを呼ぶと、引数で渡したモジュールが`include`されているかどうかがわかる。
```ruby
Product.include?(Loggable) #=> true
```
また、included_modulesメソッドを呼ぶと、includeされているモジュールの配列が返る。
```ruby
Product.include_modules #=> [Loggable, Kernel]
```
ancestorsメソッドを使うと、モジュールだけでなくスーパークラスの情報も配列になって返ってくる。
```ruby
Product.ancestors #=> [Product, Loggable, Object, Kernel, BasicObject]
```
クラスオブジェクトではなく、クラスのインスタンスからも`include`されているモジュールの情報は取得できる。たとえば、classメソッドを使うと自分が属しているクラスのクラスオブジェクトが取得できるため、そこから`include?`メソッドや`included_modules`メソッドを呼ぶことができる。
```ruby
product = Product.new
# product.classはProductクラスを返す
product.class.include?(Loggable) #=> true
product.class.included_modules   #=> [Loggable, Kernel]
```
また、`is_a?`メソッドを使えば、直接インスタンスに対して自クラスがそのモジュールを`include`しているかどうかがわかる。
```ruby
product.is_a?(Product)  #=> true
# 引数が自クラス、includeしているモジュール、スーパークラスのいずれかに該当すればtrue
product.is_a?(Product)   #=> true
product.is_a?(Loggable)  #=> ture
product.is_a?(Object)    #=> true
```
#### Enumerableモジュール
Enumerableモジュールは配列やハッシュ、範囲（Range）など、何かしらの繰り返し処理ができるクラスに`include`されているモジュール。Enumerableモジュールが`include`されていることは、以下のようにクラスに対して、`include?`メソッドを呼び出すとわかる。
```ruby
Array.include?(Enumerable)  #=> true
Hash.include?(Enumerable)   #=> true
Range.include?(Enumerable)  #=> true
```
Enumerableモジュールには数多くのメソッドが定義されている。代表的なメソッドをいくつか挙げると......
```ruby
map      select      find      count
```
Enumerableモジュールを`include`しているクラスであれば、上のメソッドはいずれも呼び出すことが可能。
```ruby
# 配列、ハッシュ、範囲でmapメソッドを使う
irb(main):001> [1, 2, 3].map { |n| n * 10 }
=> [10, 20, 30]
irb(main):002> { a: 1, b: 2, c: 3 }.map { |k, v| [k, v * 10] }
=> [[:a, 10], [:b, 20], [:c, 30]]
irb(main):003> (1..3).map { |n| n * 10 }
=> [10, 20, 30]

# 配列、ハッシュ、範囲でcountメソッドを使う
irb(main):004> [1, 2, 3].count
=> 3
irb(main):005> { a: 1, b: 2, c: 3 }.count
=> 3
irb(main):006> (1..3).count
=> 3
```

#### Comparableモジュールと <=> 演算子
Comparableモジュールは比較演算を可能にする（つまり値の大小を判定できるようにする）モジュール。Comparableモジュールを`include`すると以下のメソッド（演算子）が使えるようになる。
```ruby
<      <=      ==      >      >=      between?
```
Comparableモジュールのメソッドを使えるようにするための条件は、`include`先のクラスで`<=>`演算子を実装しておくこと。`<=>`演算子はその形状から「宇宙船演算子（もしくは UFO演算子）」とも呼ばれる演算子で、`a <=> b`が次のような結果を返すように実装する必要がある。
- **a が b より大きいなら正の整数**
- **a と b が等しいなら 0**
- **a が b より小さいなら負の整数**
- **a と b が比較できない場合は nil**

文字列や数値を使って、`<=>`演算子の戻り値を見てみる。
```ruby
irb(main):007> 2 <=> 1
=> 1
irb(main):008> 2 <=> 2
=> 0
irb(main):009> 1 <=> 2
=> -1
irb(main):010> 2 <=> 'abc'
=> nil

irb(main):011> 'xyz' <=> 'abc'
=> 1
irb(main):012> 'abc' <=> 'abc'
=> 0
irb(main):013> 'abc' <=> 'xyz'
=> -1
irb(main):014> 'abc' <=> 123
=> nil
```
Comparableモジュールを独自のクラスに`include`して使うこともできる。たとえば、音楽のテンポ（曲の速さ）を表すクラスを作り、Comparableモジュールを`include`してみる。
```ruby
irb(main):001* class Tempo
irb(main):002*   include Comparable

irb(main):003*   attr_reader :bpm

# bpmはBeats Per Minuteの略で音楽の速さを表す単位
irb(main):004*   def initialize(bpm)
irb(main):005*     @bpm = bpm
irb(main):006*   end

# <=>はComparableモジュールで使われる演算子（メソッド）
irb(main):007*   def <=>(other)
# otherがTempoであればbpm同士を<=>で比較した結果を返す
# それ以外は比較できないのでnilを返す
irb(main):008*     other.is_a?(Tempo) ? bpm <=> other.bpm : nil
irb(main):009*   end

# irb上で結果を見やすくするためにinspectメソッドをオーバーライド
irb(main):010*   def inspect
irb(main):011*     "#{bpm}bpm"
irb(main):012*   end
irb(main):013> end
=> :inspect

# 大小関係を比較してみる
irb(main):014> t_120 = Tempo.new(120)
=> 120bpm
irb(main):015> t_180 = Tempo.new(180)
=> 180bpm

irb(main):016> t_120 > t_180
=> false
irb(main):017> t_120 <= t_180
=> true
irb(main):018> t_120 == t_180
=> false
```


-------------


## ✍🏻 感想
### 🎁 自分へのご褒美
一昨日の水曜日、Apple丸の内まで出掛けて、Magic Trackpad と Magic Keyboard を購入しました。帰宅後はデスク周りの整理し、パッドとキーボードの再設定を行いました。その結果、以前よりも肩や首への負担が減り、かなり楽になりました。HHKB の打鍵感も好きですが、私は薄いキーのキーボードが好きです⌨️🫶🏻

<a href="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBLy9XQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--e839e87d65118fe2c475ccd960a7603b35ed61fa/IMG_1027.jpeg" target="_blank" rel="noopener noreferrer"><img src="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBLy9XQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--e839e87d65118fe2c475ccd960a7603b35ed61fa/IMG_1027.jpeg" width="2268" height="4032" alt="IMG_1027.jpeg"></a>

<a href="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBd0RYQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--2265315390efc1977cb8b58c7bec95685fe639a0/IMG_1031.jpeg" target="_blank" rel="noopener noreferrer"><img src="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBd0RYQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--2265315390efc1977cb8b58c7bec95685fe639a0/IMG_1031.jpeg" width="2268" height="4032" alt="IMG_1031.jpeg"></a>

<a href="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBd0hYQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c703aefeb45c75e6d0bd59e7db3b2b08a7709564/IMG_1049.jpeg" target="_blank" rel="noopener noreferrer"><img src="https://bootcamp.fjord.jp/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBd0hYQXc9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--c703aefeb45c75e6d0bd59e7db3b2b08a7709564/IMG_1049.jpeg" width="4032" height="2268" alt="IMG_1049.jpeg"></a>


### 💎 明日は『TokyoWomen.rb #1』
素敵な方々、スゴイ方々が多く参加されるイベントに未熟者の私が参加してもよいのだろうか？という不安もありますが、「一つでも多く知見を持って帰ろう！」という気持ちでいます。明日ご参加される皆さんよろしくお願いいたします😊🙏🏻


------------


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp; 3 hours 11 min
- Total: 977 hours 52 min
