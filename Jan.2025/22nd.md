# 2025/01/22(水)
## 📚 プラクティス『Ruby中級』


## 🧩 タスクばらし
- [x] プラクティスの内容を咀嚼
- [x] タスクばらし、スモールステップの作成
- [x] 各参考ページを確認
- [ ] 参考書籍：[プロを目指す人のためのRuby入門 <改訂2版>](https://www.amazon.co.jp/dp/4297124378/)を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる


## 🐾 スモールステップ
<details><summary>プラクティスの内容を咀嚼</summary>

- [x] プラクティスの内容を咀嚼
</details>

<details><summary>タスクばらし、スモールステップの作成</summary>

- [x] タスクばらし、スモールステップの作成
</details>

<details><summary>各参考ページを確認</summary>

- [x] [学習を加速させるインデックス読書術](https://qiita.com/dkatsura/items/3364b293ed1451a66a8a)を再読
- [x] 動画：[著者自身が語る「プロを目指す人のためのRuby入門」の効果的な読み方](https://www.youtube.com/watch?v=qqqbHXarPO8)
</details>

<details><summary>参考書籍：プロを目指す人のためのRuby入門 <改訂2版>を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる</summary>

- [x] 第1章  本書を読み進める前に
   - [x] 1.1 イントロダクション
   - [x] 1.2 本書の概要
   - [x] 1.3 Ruby について
   - [x] 1.4 Ruby のインストール
   - [x] 1.5 エディタ/IDE について
   - [x] 1.6 Ruby を動かしてみる
   - [x] 1.7 本書のサンプルコードについて
   - [x] 1.8 Ruby の公式リファレンスについて
   - [x] 1.9 この章のまとめ
- [x] 第2章  Ruby の基礎を理解する
   - [x] 2.1 イントロダクション
   - [x] 2.2 Ruby に関する基礎知識
   - [x] 2.3 文字列
   - [x] 2.4 数値
   - [x] 2.5 真偽値と条件分岐
   - [x] 2.6 メソッドの定義
   - [x] 2.7 例題：FizzBuzzプログラムを作成する
   - [x] 2.8 文字列についてもっと詳しく
   - [x] 2.9 数値についてもっと詳しく
   - [x] 2.10 真偽値と条件分岐についてもっと詳しく
   - [x] 2.11 メソッド定義についてもっと詳しく
   - [x] 2.12 そのほかの基礎知識
   - [x] 2.13 この章のまとめ
- [x] 第3章  テストを自動化する
   - [x] 3.1 イントロダクション
   - [x] 3.2 Minitest の基本
   - [x] 3.3 FizzBuzzプログラムのテスト自動化
   - [x] 3.4 この章のまとめ
- [x] 第4章  配列や繰り返し処理を理解する
   - [x] 4.1 イントロダクション
   - [x] 4.2 配列
   - [x] 4.3 ブロック
   - [x] 4.4 ブロックを使う配列のメソッド
   - [x] 4.5 範囲（Range）
   - [x] 4.6 例題：RGB変換プログラムを作成する
   - [x] 4.7 配列についてもっと詳しく
   - [x] 4.8 ブロックについてもっと詳しく
   - [x] 4.9 範囲（Range）についてもっと詳しく
   - [x] 4.10 さまざまな繰り返し処理
   - [x] 4.11 繰り返し処理用の制御構造
   - [x] 4.12 この章のまとめ
- [ ] 第5章  ハッシュやシンボルを理解する
   - [ ] 5.1 イントロダクション
   - [ ] 5.2 ハッシュ
   - [ ] 5.3 シンボル
   - [ ] 5.4 続・ハッシュについて
   - [ ] 5.5 例題：長さの単位交換プログラムを作成する
   - [ ] 5.6 ハッシュとキーワード引数についてもっと詳しく
   - [ ] 5.7 シンボルについてもっと詳しく
   - [ ] 5.8 この章のまとめ
- [ ] 第6章  正規表現を理解する
   - [ ] 6.1 イントロダクション
   - [ ] 6.2 正規表現って何？
   - [ ] 6.3 Ruby における正規表現オブジェクト
   - [ ] 6.4 例題：Ruby のハッシュ記法を変換する
   - [ ] 6.5 正規表現オブジェクトについてもっと詳しく
   - [ ] 6.6 この章のまとめ
- [ ] 第7章  クラスの作成を理解する
   - [ ] 7.1 イントロダクション
   - [ ] 7.2 オブジェクト指向プログラミングの基礎知識
   - [ ] 7.3 クラスの定義
   - [ ] 7.4 例題：改札機プログラムの作成
   - [ ] 7.5 selfキーワード
   - [ ] 7.6 クラスの継承
   - [ ] 7.7 メソッドの可視性
   - [ ] 7.8 定数についてもっと詳しく
   - [ ] 7.9 さまざまな種類の変数
   - [ ] 7.10 クラス定義や Ruby の言語使用に関する高度な話題
   - [ ] 7.11 この章のまとめ
- [ ] 第8章  モジュールを理解する
   - [ ] 8.1 イントロダクション
   - [ ] 8.2 モジュールの概要
   - [ ] 8.3 モジュールを利用したメソッド定義（include と extend）
   - [ ] 8.4 例題：rainbowメソッドの作成
   - [ ] 8.5 モジュールを利用したメソッド定義についてもっと詳しく
   - [ ] 8.6 モジュールを利用した名前空間の作成
   - [ ] 8.7 関数や定数を提供するモジュールの作成
   - [ ] 8.8 状態を保持するモジュールの作成
   - [ ] 8.9 モジュールに関する高度な話題
   - [ ] 8.10 この章のまとめ
- [ ] 第9章  例外処理を理解する
   - [ ] 9.1 イントロダクション
   - [ ] 9.2 例外の捕捉
   - [ ] 9.3 意図的に例外を発生させる
   - [ ] 9.4 例外処理のベストプラクティス
   - [ ] 9.5 例題：正規表現チェッカープログラムの作成
   - [ ] 9.6 例外処理についてもっと詳しく
   - [ ] 9.7 この章のまとめ
- [ ] 第10章  yield と Proc を理解する
   - [ ] 10.1 イントロダクション
   - [ ] 10.2 ブロックを利用するメソッドの定義と yield
   - [ ] 10.3 Procオブジェクト
   - [ ] 10.4 例題：ワードシンセサイザーの作成
   - [ ] 10.5 Procオブジェクトについてもっと詳しく
   - [ ] 10.6 この章のまとめ
- [ ] 第11章  パターンマッチを理解する
   - [ ] 11.1 イントロダクション
   - [ ] 11.2 パターンマッチの基本
   - [ ] 11.3 パターンマッチの利用パターン
   - [ ] 11.4 例題：ログフォーマッターの作成
   - [ ] 11.5 パターンマッチについてもっと詳しく
   - [ ] 11.6 この章のまとめ
- [ ] 第12章  Ruby のデバッグ技法を身につける
   - [ ] 12.1 イントロダクション
   - [ ] 12.2 バックトレースの読み方
   - [ ] 12.3 よく発生する例外クラスとその原因
   - [ ] 12.4 プログラムの途中経過を確認する
   - [ ] 12.5 汎用的なトラブルシューティング方法
   - [ ] 12.6 この章のまとめ
- [ ] 第13章  Ruby に関するその他のトピック
   - [ ] 13.1 イントロダクション
   - [ ] 13.2 日付や時刻の扱い
   - [ ] 13.3 ファイルやディレクトリの扱い
   - [ ] 13.4 特定の形式のファイルを読み書きする
   - [ ] 13.5 環境変数や起動時引数の取得
   - [ ] 13.6 非推奨機能を使ったときに警告を出力する
   - [ ] 13.7 eval、バッククオートリテラル、sendメソッド
   - [ ] 13.8 Rake
   - [ ] 13.9 gem と Bundler
   - [ ] 13.10 Ruby における型情報の定義と型検査（RBS、TypeProf、Steep）
   - [ ] 13.11 「Rails の中の Ruby」と「素の Ruby」の違い
   - [ ] 13.12 この章のまとめ

</details>


------------


## 🧑🏻‍💻 本日の取り組み
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
   - 第4章  配列や繰り返し処理を理解する
      - 4.10 さまざまな繰り返し処理 途中 〜 4.12 この章のまとめ


## 🎯 次回
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
   - 第5章  ハッシュやシンボルを理解する


------------


## 💡 本日の学び・気付き
### 🍒 プロを目指す人のためのRuby入門 <改訂2版>
#### 4.8 ブロックについてもっと詳しく
##### for文
配列やハッシュは for文で繰り返し処理することもできる。
```ruby
for 変数 in 配列やハッシュ
  繰り返し処理
end
```
```ruby
# 配列の中身を順番に加算して行くコード例
numbers = [1, 2, 3, 4]
sum = 0
for n in numbers
  sum += n
end
irb(main):330> sum
=> 10

# doを入れて1行で書くことも可能
sum = 0
for n in numbers do sum += n end
irb(main):333> sum
=> 10
```
↑上記の for文は eachメソッドを使ったコードとほぼ同じ。Ruby のプログラムでは通常、for文よりも eachメソッドを使う。
```ruby
numbers = [1, 2, 3, 4]
sum = 0
numbers.each do |n|
  sum += n
end
irb(main):339> sum
=> 10
```
for文と eachメソッドとの違いは、for文の場合は**配列の要素を受け取る変数や for文の中で作成したローカル変数が for文の外でも使える**、という違いがある。
```ruby
numbers = [1, 2, 3, 4]
sum = 0
numbers.each do |n|
  sum_value = n.even? ? n * 10 : n
  sum += sum_value
end
# ブロックパラメータやブロック内で作成した変数はブロックの外では参照できない
irb(main):007> n
undefined local variable or method `n' for main (NameError)
irb(main):008> sum_value
undefined local variable or method `sum_value' for main (NameError)


sum = 0
numbers = [1, 2, 3, 4]
for n in numbers
  sum_value = n.even? ? n * 10 : n
  sum += sum_value
end
# for文の中で作成された変数はfor文の外でも参照できる
irb(main):014> n
=> 4
irb(main):015> sum_value
=> 40
```
ちょっとした違いがあるものの、Ruby では for文ではなく eachメソッドや mapメソッドといった、繰り返し処理用のメソッドを使う場合がほとんど。

##### loopメソッド
無限ループを作りたい場合は、while文で以下のようなコードが書ける。
```ruby
while true
  # 無限ループ用の処理
end
```
`Kernel`モジュールの `loop`メソッドとブロックを使う方法もある。
```ruby
loop do
  # 無限ループ用の処理
end
```
無限ループから脱出する場合は`break`を使う。
```ruby
# 配列に格納した5つの数値の中からランダムに数値を選び、5が出たタイミングで脱出する無限ループ
irb(main):016> numbers = [1, 2, 3, 4, 5]
=> [1, 2, 3, 4, 5]
irb(main):017* loop do
  # sampleメソッドでランダムに要素を1つ取得する
irb(main):018*   n = numbers.sample
irb(main):019*   puts n
irb(main):020*   break if n == 5
irb(main):021> end
1
3
4
3
1
1
2
3
5
=> nil

# 上記の処理はwhile文で書くこともできる
irb(main):022* while true
irb(main):023*   n = numbers.sample
irb(main):024*   puts n
irb(main):025*   break if n == 5
irb(main):026> end
1
5
=> nil
```
`loop`メソッドはブロックを使うため変数`n`がループの外で参照できない。一方、while文はループの外でも`n`が参照できる。

##### 再起呼び出し
**あるメソッドの中でそのメソッド自信をもう一度呼び出す**ことを**再起呼び出し**と言う。再起呼び出しも繰り返し処理として使うことができる。
```ruby
# 再起呼び出しを使って階乗の計算結果を求める
irb(main):027* def factorial(n)
  # 引数の値を1減らして、factorialメソッド自身をもう一度呼び出す（一種の繰り返し処理）
  # 引数が0になったら1を返して繰り返し処理が終了する
irb(main):028*   n > 0 ? n * factorial(n - 1) : 1
irb(main):029> end
=> :factorial
irb(main):030> factorial(5)
=> 120
irb(main):031> factorial(1)
=> 1
```

#### 4.11 繰り返し処理用の制御構造
Ruby には繰り返し処理の動きを変えるための制御構造が用意されている。
- break
- next
- redo

`Kernel`モジュールの`throw`メソッドと`catch`メソッドも`break`と同じような用途で使われる。

##### break
`break`を使うと、繰り返し処理を脱出することができる。
```ruby
# shuffleメソッドで配列の要素をランダムに並び替える
irb(main):057> numbers = [1, 2, 3, 4, 5].shuffle
=> [2, 4, 5, 1, 3]
irb(main):058* numbers.each do |n|
irb(main):059*   puts n
# 5が出たら繰り返しを脱出する
irb(main):060*   break if n == 5
irb(main):061> end
2
4
5
=> nil
```
`break`は`each`メソッドだけでなく、while文や until文、for文でも使うことができる。
```ruby
# breakをwhile文を使って書いてみる
irb(main):062> numbers = [1, 2, 3, 4, 5].shuffle
=> [1, 4, 2, 3, 5]
irb(main):063> i = 0
=> 0
irb(main):064* while i < numbers.size
irb(main):065*   n = numbers[i]
irb(main):066*   puts n
irb(main):067*   break if n == 5
irb(main):068*   i += 1
irb(main):069> end
1
4
2
3
5
=> nil
```
`break`に引数を渡すと、while文や for文の戻り値になる。引数を渡さない場合の戻り値は`nil`。
```ruby
irb(main):070* ret =
irb(main):071*   while true
irb(main):072*     break
irb(main):073>   end
irb(main):074> ret
=> nil

irb(main):075* ret =
irb(main):076*   while true
irb(main):077*     break 123
irb(main):078>   end
irb(main):079> ret
=> 123
```
繰り返し処理が入れ子になっている場合は、一番内側の繰り返し処理を脱出する。
```ruby
irb(main):080> fruits = ['apple', 'melon', 'orange']
=> ["apple", "melon", "orange"]
irb(main):081> numbers = [1, 2, 3]
=> [1, 2, 3]
irb(main):082* fruits.each do |fruit|
# 配列の数字をランダムに入れ替え、3が出たらbreakする
irb(main):083*   numbers.shuffle.each do |n|
irb(main):084*     puts "#{fruit}, #{n}"
# numbersのループは脱出するが、fruitsのループは継続する
irb(main):085*     break if n == 3
irb(main):086*   end
irb(main):087> end
apple, 2
apple, 3
melon, 2
melon, 1
melon, 3
orange, 3
```

##### next
繰り返し処理を途中で中断し、次の繰り返し処理に進める場合は`next`を使う。
```ruby
# 偶数であれば処理を中断して次の繰り返し処理に進むコード例
irb(main):013> numbers = [1, 2, 3, 4, 5]
=> [1, 2, 3, 4, 5]
irb(main):014* numbers.each do |n|
irb(main):015*   next if n.even?
irb(main):016*   puts n
irb(main):017> end
1
3
5
```
`each`メソッドの中だけでなく、while文や until文、for文の中でも使える点や、入れ子になった繰り返し処理ではいちばん内側のループだけが中断の対象になる点は`break`と同じ。
```ruby
irb(main):018> numbers = [1, 2, 3, 4, 5]
=> [1, 2, 3, 4, 5]
irb(main):019> i = 0
=> 0
irb(main):020* while i < numbers.size
irb(main):021*   n = numbers[i]
irb(main):022*   i += 1
# while文の中でnextを使う
irb(main):023*   next if n.even?
irb(main):024*   puts n
irb(main):025> end
1
3
5

irb(main):026> fruits = ['apple', 'melon', 'orange']
=> ["apple", "melon", "orange"]
irb(main):027> numbers = [1, 2, 3, 4]
=> [1, 2, 3, 4]
irb(main):028* fruits.each do |fruit|
irb(main):029*   numbers.each do |n|
# 繰り返し処理が入れ子になっている場合は、一番内側のループだけが中断される
irb(main):030*     next if n.even?
irb(main):031*     puts "#{fruit}, #{n}"
irb(main):032*   end
irb(main):033> end
apple, 1
apple, 3
melon, 1
melon, 3
orange, 1
orange, 3
```

##### redo
繰り返し処理をやり直したい場合は`redo`を使う。
```ruby
irb(main):041> foods = ['ピーマン', 'トマト', 'セロリ']
=> ["ピーマン", "トマト", "セロリ"]
irb(main):042* foods.each do |food|
irb(main):043*   print "#{food}は好きですか？ => "
# sampleは配列からランダムに1要素を取得するメソッド
irb(main):044*   answer = ['はい', 'いいえ'].sample
irb(main):045*   puts answer
# はいと答えなければもう一度聞き直す
irb(main):046*   redo unless answer == 'はい'
irb(main):047> end
ピーマンは好きですか？ => はい
トマトは好きですか？ => いいえ
トマトは好きですか？ => いいえ
トマトは好きですか？ => いいえ
トマトは好きですか？ => はい
セロリは好きですか？ => はい
```
`redo`を使う場合、状況によっては永遠にやり直しが続き、無限ループになる可能性がある。そのため、やり直しの回数を制限することを検討するように。
```ruby
irb(main):048> foods = ['ピーマン', 'トマト', 'セロリ']
=> ["ピーマン", "トマト", "セロリ"]
irb(main):049> count = 0
=> 0
irb(main):050* foods.each do |food|
# わざと「いいえ」しか答えないようにする
irb(main):051*   print "#{food}は好きですか？ => "
irb(main):052*   answer = 'いいえ'
irb(main):053*   puts answer
irb(main):054*   count += 1
# やり直しは2回までにする
irb(main):055*   redo if answer != 'はい' && count < 2
# カウントをリセット
irb(main):056*   count = 0
irb(main):057> end
ピーマンは好きですか？ => いいえ
ピーマンは好きですか？ => いいえ
トマトは好きですか？ => いいえ
トマトは好きですか？ => いいえ
セロリは好きですか？ => いいえ
セロリは好きですか？ => いいえ
```

#### 4.12 この章のまとめ
この章で学習した内容は、
- **配列**
- **ブロック**
- **範囲（Range）**
- **さまざまな繰り返し処理**
- **繰り返し処理用の制御構造**

配列やブロックは Ruby において**利用頻度が非常に高い機能**。配列に用意された豊富なメソッドを使いこなせば使いこなすほど簡潔なプログラムが書けるようになる。


-------------


## ✍🏻 感想
### 🍒 配列とブロックとは親友になりたい
配列とブロックを非常に頻繁に使用される機能であることを学びながら実感しました。可読性が高く、簡潔なプログラムが書くためには「配列とブロックとは親友にならなくては！」と思いました。現在は顔見知り程度なので、何度も読み直して「顔見知り → 友人・知人 → 親友」と絆を深めていきたいです。

------------


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp; 2 hours 17 min
- Total: 897 hours 23 min
