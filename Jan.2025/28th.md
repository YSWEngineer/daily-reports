# 2025/01/28(火)
## 📚 プラクティス『Ruby中級』


## 🧩 タスクばらし
- [x] プラクティスの内容を咀嚼
- [x] タスクばらし、スモールステップの作成
- [x] 各参考ページを確認
- [ ] 参考書籍：[プロを目指す人のためのRuby入門 <改訂2版>](https://www.amazon.co.jp/dp/4297124378/)を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる


## 🐾 スモールステップ
<details><summary>プラクティスの内容を咀嚼</summary>

- [x] プラクティスの内容を咀嚼
</details>

<details><summary>タスクばらし、スモールステップの作成</summary>

- [x] タスクばらし、スモールステップの作成
</details>

<details><summary>各参考ページを確認</summary>

- [x] [学習を加速させるインデックス読書術](https://qiita.com/dkatsura/items/3364b293ed1451a66a8a)を再読
- [x] 動画：[著者自身が語る「プロを目指す人のためのRuby入門」の効果的な読み方](https://www.youtube.com/watch?v=qqqbHXarPO8)
</details>

<details><summary>参考書籍：プロを目指す人のためのRuby入門 <改訂2版>を読んで、実際に手を動かしてツールを使ってみてコードを書いてみる</summary>

- [x] 第1章  本書を読み進める前に
   - [x] 1.1 イントロダクション
   - [x] 1.2 本書の概要
   - [x] 1.3 Ruby について
   - [x] 1.4 Ruby のインストール
   - [x] 1.5 エディタ/IDE について
   - [x] 1.6 Ruby を動かしてみる
   - [x] 1.7 本書のサンプルコードについて
   - [x] 1.8 Ruby の公式リファレンスについて
   - [x] 1.9 この章のまとめ
- [x] 第2章  Ruby の基礎を理解する
   - [x] 2.1 イントロダクション
   - [x] 2.2 Ruby に関する基礎知識
   - [x] 2.3 文字列
   - [x] 2.4 数値
   - [x] 2.5 真偽値と条件分岐
   - [x] 2.6 メソッドの定義
   - [x] 2.7 例題：FizzBuzzプログラムを作成する
   - [x] 2.8 文字列についてもっと詳しく
   - [x] 2.9 数値についてもっと詳しく
   - [x] 2.10 真偽値と条件分岐についてもっと詳しく
   - [x] 2.11 メソッド定義についてもっと詳しく
   - [x] 2.12 そのほかの基礎知識
   - [x] 2.13 この章のまとめ
- [x] 第3章  テストを自動化する
   - [x] 3.1 イントロダクション
   - [x] 3.2 Minitest の基本
   - [x] 3.3 FizzBuzzプログラムのテスト自動化
   - [x] 3.4 この章のまとめ
- [x] 第4章  配列や繰り返し処理を理解する
   - [x] 4.1 イントロダクション
   - [x] 4.2 配列
   - [x] 4.3 ブロック
   - [x] 4.4 ブロックを使う配列のメソッド
   - [x] 4.5 範囲（Range）
   - [x] 4.6 例題：RGB変換プログラムを作成する
   - [x] 4.7 配列についてもっと詳しく
   - [x] 4.8 ブロックについてもっと詳しく
   - [x] 4.9 範囲（Range）についてもっと詳しく
   - [x] 4.10 さまざまな繰り返し処理
   - [x] 4.11 繰り返し処理用の制御構造
   - [x] 4.12 この章のまとめ
- [ ] 第5章  ハッシュやシンボルを理解する
   - [x] 5.1 イントロダクション
   - [x] 5.2 ハッシュ
   - [x] 5.3 シンボル
   - [x] 5.4 続・ハッシュについて
   - [x] 5.5 例題：長さの単位交換プログラムを作成する
   - [ ] 5.6 ハッシュとキーワード引数についてもっと詳しく
   - [ ] 5.7 シンボルについてもっと詳しく
   - [ ] 5.8 この章のまとめ
- [ ] 第6章  正規表現を理解する
   - [ ] 6.1 イントロダクション
   - [ ] 6.2 正規表現って何？
   - [ ] 6.3 Ruby における正規表現オブジェクト
   - [ ] 6.4 例題：Ruby のハッシュ記法を変換する
   - [ ] 6.5 正規表現オブジェクトについてもっと詳しく
   - [ ] 6.6 この章のまとめ
- [ ] 第7章  クラスの作成を理解する
   - [ ] 7.1 イントロダクション
   - [ ] 7.2 オブジェクト指向プログラミングの基礎知識
   - [ ] 7.3 クラスの定義
   - [ ] 7.4 例題：改札機プログラムの作成
   - [ ] 7.5 selfキーワード
   - [ ] 7.6 クラスの継承
   - [ ] 7.7 メソッドの可視性
   - [ ] 7.8 定数についてもっと詳しく
   - [ ] 7.9 さまざまな種類の変数
   - [ ] 7.10 クラス定義や Ruby の言語使用に関する高度な話題
   - [ ] 7.11 この章のまとめ
- [ ] 第8章  モジュールを理解する
   - [ ] 8.1 イントロダクション
   - [ ] 8.2 モジュールの概要
   - [ ] 8.3 モジュールを利用したメソッド定義（include と extend）
   - [ ] 8.4 例題：rainbowメソッドの作成
   - [ ] 8.5 モジュールを利用したメソッド定義についてもっと詳しく
   - [ ] 8.6 モジュールを利用した名前空間の作成
   - [ ] 8.7 関数や定数を提供するモジュールの作成
   - [ ] 8.8 状態を保持するモジュールの作成
   - [ ] 8.9 モジュールに関する高度な話題
   - [ ] 8.10 この章のまとめ
- [ ] 第9章  例外処理を理解する
   - [ ] 9.1 イントロダクション
   - [ ] 9.2 例外の捕捉
   - [ ] 9.3 意図的に例外を発生させる
   - [ ] 9.4 例外処理のベストプラクティス
   - [ ] 9.5 例題：正規表現チェッカープログラムの作成
   - [ ] 9.6 例外処理についてもっと詳しく
   - [ ] 9.7 この章のまとめ
- [ ] 第10章  yield と Proc を理解する
   - [ ] 10.1 イントロダクション
   - [ ] 10.2 ブロックを利用するメソッドの定義と yield
   - [ ] 10.3 Procオブジェクト
   - [ ] 10.4 例題：ワードシンセサイザーの作成
   - [ ] 10.5 Procオブジェクトについてもっと詳しく
   - [ ] 10.6 この章のまとめ
- [ ] 第11章  パターンマッチを理解する
   - [ ] 11.1 イントロダクション
   - [ ] 11.2 パターンマッチの基本
   - [ ] 11.3 パターンマッチの利用パターン
   - [ ] 11.4 例題：ログフォーマッターの作成
   - [ ] 11.5 パターンマッチについてもっと詳しく
   - [ ] 11.6 この章のまとめ
- [ ] 第12章  Ruby のデバッグ技法を身につける
   - [ ] 12.1 イントロダクション
   - [ ] 12.2 バックトレースの読み方
   - [ ] 12.3 よく発生する例外クラスとその原因
   - [ ] 12.4 プログラムの途中経過を確認する
   - [ ] 12.5 汎用的なトラブルシューティング方法
   - [ ] 12.6 この章のまとめ
- [ ] 第13章  Ruby に関するその他のトピック
   - [ ] 13.1 イントロダクション
   - [ ] 13.2 日付や時刻の扱い
   - [ ] 13.3 ファイルやディレクトリの扱い
   - [ ] 13.4 特定の形式のファイルを読み書きする
   - [ ] 13.5 環境変数や起動時引数の取得
   - [ ] 13.6 非推奨機能を使ったときに警告を出力する
   - [ ] 13.7 eval、バッククオートリテラル、sendメソッド
   - [ ] 13.8 Rake
   - [ ] 13.9 gem と Bundler
   - [ ] 13.10 Ruby における型情報の定義と型検査（RBS、TypeProf、Steep）
   - [ ] 13.11 「Rails の中の Ruby」と「素の Ruby」の違い
   - [ ] 13.12 この章のまとめ

</details>


------------


## 🧑🏻‍💻 本日の取り組み
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
  - 第5章  ハッシュやシンボルを理解する
    - 5.6 ハッシュとキーワード引数についてもっと詳しく 途中まで


## 🎯 次回
### プラクティス『Ruby中級』
- 参考書籍：『プロを目指す人のためのRuby入門 <改訂2版>』を読み進める
  - 第5章  ハッシュやシンボルを理解する
    - 5.6 ハッシュとキーワード引数についてもっと詳しく
      - 5.6.8 ハッシュから配列へ、配列からハッシュへ


------------


## 💡 本日の学び・気付き
### 5.6 ハッシュとキーワード引数についてもっと詳しく
#### ハッシュで使用頻度の高いメソッド
ハッシュで使用頻度の高いメソッド。
- keys
- values
- has_key? / key? / include? / member?

##### keys
keysメソッドは**ハッシュのキーを配列として返す**。
```ruby
currencies = { japan: 'yen', us: 'dollar', india: 'rupee' }
irb(main):002> currencies.keys
=> [:japan, :us, :india]
```

##### values
valuesメソッドは**ハッシュの値を配列として返す**。
```ruby
currencies = { japan: 'yen', us: 'dollar', india: 'rupee' }
irb(main):003> currencies.values
=> ["yen", "dollar", "rupee"]
```

##### has_key? / key? / include? / member?
has_key?メソッドは**ハッシュの中に指定されたキーが存在するかどうか確認する**メソッド。key?、include?、member? はいずれも has_key? のエイリアスメソッド。

###### おさらい：エイリアスメソッドとは？
エイリアスメソッドとは、**同じ実装で名前だけ異なるメソッド**のこと。

```ruby
currencies = { japan: 'yen', us: 'dollar', india: 'rupee' }
# 指定されたキーがハッシュの中に存在すればtrueを返す
irb(main):004> currencies.has_key?(:japan)
=> true
# 指定されたキーがハッシュの中になければfalseを返す
irb(main):005> currencies.has_key?(:italy)
=> false
```

#### ** でハッシュを展開させる
** をハッシュの前に付けるとハッシュリテラル内でほかのハッシュの要素を展開することができる。

##### おさらい：ハッシュリテラルとは？
ハッシュリテラルとは、**ハッシュを作成するときの構文**のこと。ちなみにハッシュにおいてはキーと値の組み合わせが1つの要素になる。

```ruby
h = { us: 'dollar', india: 'rupee' }
# 変数hの要素を**で展開させる
irb(main):007> { japan: 'yen', **h }
=> {:japan=>"yen", :us=>"dollar", :india=>"rupee"}

# **を付けない場合は構文エラーになる
irb(main):009> { japan: 'yen', h }
syntax error, unexpected '}', expecting => (SyntaxError)
{ japan: 'yen', h }
```
**の代わりに mergeメソッドを使っても同じ結果が得られる。
```ruby
h = { us: 'dollar', india: 'rupee' }
irb(main):011> { japan: 'yen' }.merge(h)
=> {:japan=>"yen", :us=>"dollar", :india=>"rupee"}
```

#### 任意のキーワードを受け付ける **引数
キーワード引数を使うメソッドに定義されていないキーワードを渡すとエラーが発生する。
```ruby
def buy_burger(menu, drink: true, potato: true)
  if drink
  end
  if potato
  end
end

# saladとchickenは未定義のキーワード引数なのでエラーになる
irb(main):018> buy_burger('fish', drink: true, potato: false, salad: true, chicken: false)
unknown keywords: :salad, :chicken (ArgumentError)
```
しかし、任意のキーワードも同時に受け取りたい場合は**を付けた引数を最後に用意する。**を付けた引数にはキーワード引数で指定されていないキーワードがハッシュとして格納される。
```ruby
# 想定外のキーワードはothers引数で受け取る
def buy_burger(menu, drink: true, potato: true, **others)
  # othersはハッシュとして渡される
  puts others
  if drink
  end
  if potato
  end
end

irb(main):026> buy_burger('fish', drink: true, potato: false, salad: true, chicken: false)
{:salad=>true, :chicken=>false}
```

#### ハッシュを明示的にキーワード引数に変換する**
Ruby 2.0 から 2.7 では以下のコードのようにハッシュを引数として渡すと、それが自動的にキーワード引数に変換されていた。
```ruby
def buy_burger(menu, drink: true, potato: true)
  if drink
  end
  if potato
  end
end

# キーワード引数として渡したいハッシュを定義する
params = { drink: true, potato: false }
# ハッシュを引数として渡すと自動的にキーワード引数に変換される（Ruby 2.x）
buy_burger('fish', params)
```
Ruby 3.0 ではキーワード引数への自動変換が行われないため、エラーが発生する。これは「キーワード引数の分離」と呼ばれる Ruby 3.0 の仕様変更による影響。
```ruby
# Ruby 3.0ではハッシュはキーワード引数に自動変換されないため、エラーが発生する
irb(main):034> buy_burger('fish', params)
`buy_burger': wrong number of arguments (given 2, expected 1) (ArgumentError)
```

#### メソッド呼び出し時の {} の省略
Ruby では「最後の引数がハッシュであればハッシュリテラルの {} を省略できる」というルールがある。
```ruby
# optionsは任意のハッシュを受け付ける
def buy_burger(menu, options = {})
  puts options
end
```
キーワード引数の場合は呼び出し時に必ず引数名をシンボルで指定する必要がある。ここではキーワード引数との違いを明確にするため、以下のようにキーを文字列にしたハッシュを渡すことにする。
```ruby
# ハッシュを第2引数として渡す
irb(main):038> buy_burger('fish', {'drink' => true, 'potato' => false})
{"drink"=>true, "potato"=>false}
```
「最後の引数がハッシュであればハッシュリテラルの {} を省略できる」というルールでコードを書く。
```ruby
# ハッシュリテラルの{}を省略してメソッドを呼び出す
irb(main):039> buy_burger('fish', 'drink' => true, 'potato' => false)
{"drink"=>true, "potato"=>false}
```
「最後の引数がハッシュであれば」という条件なので、以下のように最後の引数にハッシュがきていない場合はエラーになる。
```ruby
# menuとoptionsの順番を入れ替える
def buy_burger(options = {}, menu)
  puts options
end

# optionsは最後の引数ではないので、ハッシュリテラルの{}は省略できない
irb(main):043> buy_burger('drink' => true, 'potato' => false, 'fish')
syntax error, unexpected ')', expecting => (SyntaxError)
...rue, 'potato' => false, 'fish')
...                              ^

# 最後の引数でなければ{}を付けて普通にハッシュを作成する
irb(main):044> buy_burger({'drink' => true, 'potato' => false}, 'fish')
{"drink"=>true, "potato"=>false}
```
「最後がハッシュであれば {} は省略可能」というルールは配列リテラルでも同様。たとえば、以下の a と b は同じ構造の配列を定義していることになる。
```ruby
a = ['fish', { drink: true, potato: false }]
irb(main):046> a[0]
=> "fish"
irb(main):047> a[1]
=> {:drink=>true, :potato=>false}

b = ['fish', drink: true, potato: false]
irb(main):049> b[0]
=> "fish"
irb(main):050> b[1]
=> {:drink=>true, :potato=>false}
```

#### ハッシュリテラルの {} とブロックの {}
Ruby ではメソッドの呼び出しの () を省略することができる。
```ruby
# ()ありのメソッド呼び出し
puts('Hello')

# ()なしのメソッド呼び出し
puts 'Hello'
```
以下のコードで () を省略するとどうなるか。
```ruby
def buy_burger(options = {}, menu)
  puts options
end

buy_burger({'drink' => true, 'potato' => false}, 'fish')

# ()を省略して書いてみる
irb(main):054> buy_burger {'drink' => true, 'potato' => false}, 'fish'
syntax error, unexpected `false', expecting local variable or method (SyntaxError)
...ink' => true, 'potato' => false}, 'fish'
...                          ^
```
↑エラーが出た原因は、ハッシュリテラルの {} がブロックの {} だと Ruby に解釈されたため。メソッドの第1引数にハッシュを渡そうとする場合は必ず () を付けてメソッドを呼び出す必要がある。
```ruby
# 第1引数にハッシュの{}がくる場合は()を省略できない
buy_burger({'drink' => true, 'potato' => false}, 'fish')
```
逆に、第2引数以降にハッシュがくる場合は () を省略してもエラーにならない。
```ruby
def buy_burger(options = {}, menu)
  puts options
end

# 第2引数以降にハッシュがくる場合は、()を省略してもエラーにならない
irb(main):058> buy_burger 'fish', {'drink' => true, 'potato' => false}
fish

# この場合、そもそもハッシュが最後の引数なので、{}を省略することができる
irb(main):059> buy_burger 'fish', 'drink' => true, 'potato' => false
fish
```
「ついうっかり」やってしまいがちな構文エラー
```ruby
# ついうっかり・その1「ハッシュの内容をターミナルに出力したい！→エラー」
irb(main):060> puts { foo: 1, bar: 2 }
syntax error, unexpected ':', expecting '}' (SyntaxError)

# ()で囲む必要がある
irb(main):061> puts({ foo: 1, bar: 2 })
{:foo=>1, :bar=>2}

# ついうっかり・その2「resultの内容が指定したハッシュの内容に一致するか検証したい！→エラー」
irb(main):062> assert_equal { foo: 1, bar: 2 }, result
syntax error, unexpected ':', expecting '}' (SyntaxError)

# ()で囲む必要がある
assert_equal({ foo: 1, bar: 2 }, result)
```


-------------


## ✍🏻 感想
### 🍒 ハッシュも大事なことがいっぱい
配列と同じくらいハッシュも大事なことがたくさんあり、理解するのに苦労しています。一度では理解できないので、コードを実際に打ち込んで読み書きするだけでなく、紙にも書いて読み書きを行っています。時間はかかりますが、一つずつやっていこう！


------------


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp; 2 hours 36 min
- Total: 909 hours 18 min
