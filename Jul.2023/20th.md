# 2023/07/20(木) 日報

## 取り組んだ課題
### 『Linuxの基礎コマンドを理解する』
- 『Linux標準教科書』
  - 第12章 12.1.3 Linux のディレクトリ構造 ~ 12.10 ディスクを管理するコマンド　まで修了


## 分かったこと・気付き
#### ディスクのパーティション
- fdiskコマンドで、分割されたパーティションの情報を調べたり、パーティションを作成、削除できる。

##### パーティション分割する理由
- システムとデータのバックアップ頻度を差別化する
- 障害発生時の影響範囲を狭める
- ファイルアクセスの速度向上
- 書式
```
fdisk [オプション] [デバイスファイル]
ディスクの構造を表示。
ディスクをパーティション分割する。
```
オプション
```
-l
デバイスのパーティション情報を表示。
```

##### パーティションの分割
- ハードディスクは、1つのパーティションとして使うか、2~4つまでのパーティションに分割できる。

##### パーティション分割の例
- 基本パーティションを4つ
- 基本パーティションを3つ＋拡張パーティションを1つ (論理パーティションを2つ)
- 論理パーティションは、基本パーティションと同様にファイルシステムを作成して、ファイ ルやディレクトリを保管できる。拡張パーティションは、論理パーティションを格納する役割となっており、ファイルシステムを作成することはできない。

##### パーティションの最大数
- IDE：63（基本 3 ＋論理 60）
- SATA：15（基本 3 ＋論理 12）
- SCSI：15（基本 3 ＋論理 12）
- Linux では4つ以上のパーティションが必要となるケースが多いので、拡張パーティション1つと他の3つを基本パーティションという構成で使う場合が多くなる。また、拡張されたハードディスクは基本パーティション1つや、LVM(Logical Volume Managemer) 機能を使って複数のハードディスクを統合した1つのハードディスクとして大きく使うことも多い。

##### ハードディスクを増設して利用可能にする
- 新しいハードディスクには、データ用の領域と、スワップ領域 (Linux がメモリの代わりにプログラムを置いておく領域) の2つを作成する。
- パーティションの操作はシステム管理の仕事なので、root ユーザでfdiskコマンドを実行する必要がある。

#### ファイルシステム
- ファイルシステムとは、ディレクトリやファイルの情報やデータをディスクの何処に保存してあるか管理するためのシステムのこと。
- ファイルシステムはディレクトリやファイルのファ イル名、ファイルの作成時間、ファイルの所有権限などの情報を管理している。
- ディスクのデータが書いてある場所とデータが書いていない場所なども管理している。
- Linuxの場合はディストリビューションよって異なるが、ext3もしくはext4がファイルシステムに利用されている。
	- ディストリビューション：Linuxの仕組みをベースにしたソフトウェアの集まり。

##### Linux で利用できるファイルシステムの一例
| FS 名 | 内容 | 最大サイズ | 最大ファイルサイズ |
| :---: | :--- | :---: | :---: |
| ext2 | Berkeley Fast File System を参考にした 16 ビット構造 | 16TB | 2TB |
| ext3 | ext2 にジャーナル機能付加と機能拡張 | 2～32TB | 16GB～2TB |
| ext4 | ジャーナリングファイルシステム。ファイルの断片化防止などさまざまな機能拡張によりパフォーマンスが向上 | 1EB | 16TB |
| ReiserFS | 小さなファイルの扱いに向いたジャーナリングファイルシステム | 8TB | 16TB |
| XFS | SGI社が提供したジャーナリングファイルシステム | 8EB | 8EB |
| JFS | IBM社が提供したジャーナリングファイルシステム | 512TB | 4PB～8EB |

##### 容量の単位
- 1M(メガ) バイト=1024K バイト 1G(ギガ) バイト=1024M バイト
- 1T(テラ) バイト=1024G バイト 1P(ペタ) バイト=1024T バイト
- 1E(エクサ) バイト=1024P バイト 1Z(ゼタ) バイト=1024E バイト

##### ジャーナリング機能
- ジャーナリングとは、ファイルシステムに対する書き換え処理のコマンドをファイルシステムに逐一記録する機能のこと。

##### マウント状態の表示
- `dfコマンド`で現在マウントされているファイルシステムのリストを表示できる。
-実習：ハードディスクの確認
```
YSWs-MBP:~ yoshiwo$ df
Filesystem     512-blocks      Used Available Capacity iused      ifree %iused  Mounted on
/dev/disk1s1s1  976490576  17696840 814540968     3%  355382 4072704840    0%   /
devfs                 384       384         0   100%     666          0  100%   /dev
/dev/disk1s3    976490576   4336360 814540968     1%    1952 4072704840    0%   /System/Volumes/Preboot
/dev/disk1s5    976490576   6291496 814540968     1%       3 4072704840    0%   /System/Volumes/VM
/dev/disk1s6    976490576      9896 814540968     1%      16 4072704840    0%   /System/Volumes/Update
/dev/disk1s2    976490576 131060656 814540968    14%  840032 4072704840    0%   /System/Volumes/Data
map auto_home           0         0         0   100%       0          0  100%   /System/Volumes/Data/home
/dev/disk2s2      2343752   1337336   1006416    58%     998 4294966281    0%   /Volumes/Arc
```

##### ファイルシステムの作成
- ハードディスクを利用するためには、パーティションに分割した後ファイルシステムを作成する。
- ファイルシステムの作成にはmkfsコマンドを使用する。
- 書式
```
mkfs オプション
```
- オプション
```
-t
作成するファイルシステムの種類を指定する。

-c
ハードディスクの壊れている箇所を検出して、利用しない。
```

##### ラベル
- ラベルとは、ハードディスクなどのパーティションを認識するための名前のこと。
- 書式
```
e2label デバイス [ラベル]
パーティションのラベルを表示する。
パーティションのラベルを付ける。
```
**※↓ターミナルではマニュアルに登録されていないと表示。**
```
YSWs-MBP:~ yoshiwo$ man e2label
No manual entry for e2label
```

#### マウント
- ハードディスクはパーティション分割してファイルシステムを作ってからマウントすると読み書きできる。
- CD-ROM や DVD-ROM などのリムーバブルメディアもマウントすると読めるようになる。

##### マウントポイント
- マウントするために利用するディレクトリをマウントポイントと呼ぶ。
	- マウント：外部のデバイス（例えばUSBメモリやハードディスク）を、コンピュータ内の特定の場所に接続して使えるようにすることを意味する。マウントは、外部デバイスをコンピュータに「つなげる」作業をイメージするとよい。マウントが完了すると、コンピュータは外部デバイスの中身を見ることができるようになる。

##### マウント（mountコマンド）
- ハードディスクやリムーバブルメディアなどをマウントポイントにマウントするためにmountコマンドを使う。
- 書式
```
mount -t タイプ -o オプション デバイスファイル マウントポイント
ハードディスクやリムーバブルメディアをマウントする。
```
- オプション
```
-t タイプ
ファイルシステムのext3やWindowsのmsdosCDとDVDのiso9660など

-o オプション
読み書きのrwや読み取り専用のroなど

デバイスファイル
ファイルシステムをアクセスするためのデバイスファイル

マウントポイント
マウントするディレクトリ
```

##### アンマウント（umountコマンド）
- マウントされたハードディスクやリムーバブルメディアを利用しなくなると、アンマウントする。
- アンマウントするために`umountコマンド`を使う。

#### topコマンドとpstreeコマンド
- topコマンドは実行中のプロセスの状態をダイナミックに表示する。
**※pstreeコマンドはターミナルでは使えない**
```
YSWs-MBP:~ yoshiwo$ top
Processes: 644 total, 3 running, 641 sleeping, 2702 threads                15:21:39
Load Avg: 3.40, 3.98, 4.20  CPU usage: 13.87% user, 3.46% sys, 82.65% idle
SharedLibs: 594M resident, 80M data, 46M linkedit.
MemRegions: 619304 total, 5407M resident, 186M private, 1784M shared.
PhysMem: 15G used (3093M wired, 915M compressor), 996M unused.
VM: 58T vsize, 3536M framework vsize, 15334023(0) swapins, 16055837(0) swapouts.
Networks: packets: 4311624/4759M in, 1284603/300M out.
Disks: 4647853/114G read, 3385959/93G written.

PID   COMMAND      %CPU  TIME     #TH   #WQ  #PORTS MEM    PURG   CMPRS  PGRP PPID
816   Google Chrom 99.7  03:56:49 18/1  1    217    452M   0B     47M    395  395
7793  top          20.5  00:03.10 1/1   0    27     6240K  0B     0B     7793 500
155   WindowServer 5.8   04:06:30 18    7    3353-  952M+  18M    99M    155  1
```

#### プロセス間通信
- 複数のプロセスがコミュニケーションを取りながら同期したり、動作を変更して達成することを`プロセス間通信`と呼ぶ。
- パイプやシグナルもLinuxの代表的なプロセス間通信の手法。
- ↓そのほかの手法
	- System V IPC（Inter Process Communication）
		- 共有メモリ（shared memory）
		- セマフォ（semaphore）
		- メッセージキュー（message queue）
	- ソケット
- それぞれの特徴
	- `パイプ`：１つのプロセスの標準入出力をつなぎ替えます。パイプ（｜）の左側のコマンド（プロセス）の標準出力を右側のコマンド（プロセス）の標準入力につなぐことで、通信を実現する。
	- `シグナル`：特定のシグナルの受信を持って特定の処理を開始するなど、同期を実現する。
	- `共有メモリ`（shared memory）： 特定のメモリ領域を複数のプロセスで共有することでメッ セージの受け渡し等が行える。
	- `セマフォ`（semaphore）：資源のロックを行い、複数のプロセス間で同時に書き込みをしたりしないよう排他処理を実現する。
	- `メッセージキュー`（message queue）キューにメッセージを格納しておき、複数のプロセス間での非同期の通信を実現する。
	- `ソケット`：ネットワーク経由のホスト間のプロセスでの通信を実現する。

### ファイル管理
#### Linuxのファイル管理
- Linuxのファイル管理にはハードディスクとファイルシステムとディレクトリの構造の知識が必要。
##### ファイルシステムとは
- ファイルシステムとは、ファイル名・更新日付などの属性データ・ファイルデータ本体を効率よく管理するためのしくみ。
- ファイルシステムの概要を掴むと、今までに出てきたコマンドの理解度も上がるだろう。
##### パーティションとは
- ハードディスクを利用するために、ハードディスクを区切った単位。
- ディスクの内部を複数の`パーティション（領域）`に区切る作業が必要。
- パーティションを分割する作業を`パーティショニング`と呼ぶ。


## 次の目標
- 『Linux標準教科書』 修了
- 記事の制作に着手


## 感じたこと
- 第10章で理解できなかった箇所がどうしても気になってしまい明け方まで調べていたため、今日の勉強の開始が遅くなりました。また、睡眠時間が短かったので注意力が散漫で勉強に集中できませんでした。反省です。


## 学習時間
- Today:&nbsp;&nbsp;&nbsp; 3 hours 14 min
- Total: 354 hours 28 min
