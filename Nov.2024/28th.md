# 2024/11/27(水)
## プラクティス『プログラムの修正』

## 🧩 タスクばらし
- [x] 各参考ページを確認
- [x] 参考書籍を読む
- [ ] ソースコードを修正
- [ ] 課題提出


------------


## 🐾 スモールステップ
<details><summary>各参考ページを確認</summary>

- [x] [Docs：debug.gemの使い方を学ぶ](https://bootcamp.fjord.jp/pages/how-to-use-debug-gem)
   - [x] [rubygems (debug.gem)の使い方 - YouTube](https://www.youtube.com/watch?v=4r7-uN3RvNA)
   - [x] [byebugの良さを教えてください！ | FJORD BOOT CAMP（フィヨルドブートキャンプ）](https://bootcamp.fjord.jp/questions/1162)
   - [x] [Ruby 3.1 の debug.gem を自慢したい - クックパッド開発者ブログ](https://techlife.cookpad.com/entry/2021/12/27/202133)
   - [x] [VS Codeでターミナルからの入力を伴うRubyプログラムをデバッグ実行する方法 - Qiita](https://qiita.com/jnchito/items/3254118d666ef1ea2923)
   - [x] [Railsをステップ実行する方法を学ぶ（VS CodeとRubyMine） | FJORD BOOT CAMP（フィヨルドブートキャンプ）](https://bootcamp.fjord.jp/pages/how-to-debug-rails)


</details>


<details><summary>参考書籍を読む</summary>

- [x] コードが動かないので帰れません！新人プログラマーのためのエラーが怖くなくなる本
   - [x] 第1章 エラーはどうして怖いのか？
   - [x] 第2章 エラーの上手な読み方
   - [x] 第3章 不具合の原因を効率的に見つけるには？
   - [x] 第4章 ツールを活用してデバッグを楽にしよう
   - [x] 第5章 どうしても解決できない時は？
   - [x] 第6章 デバッグしやすいコードを書こう

</details>


<details><summary>ソースコードを修正</summary>

- [ ] ソースコードを修正

</details>


<details><summary>課題提出</summary>

- [ ] 修正したソースコードを Pull Request としてアップ
- [ ] Pull Request した URL と Terminal での実行結果をメンターさんに提出

</details>


------------


## 🕺 プラクティス終了後の姿
- **エラーの無いバグの探し方がわかる**💡
- **さらにデバッグツールに親しむ**🫂


------------


## 🧑🏻‍💻 本日の取り組み
### Advent Calendar
- ブラッシュアップ

### プラクティス『プログラムの修正』
- 参考書籍を読む
   - コードが動かないので帰れません！新人プログラマーのためのエラーが怖くなくなる本
      - 第4章 ツールを活用してデバッグを楽にしよう
         - 4-3 いろいろなステップ実行 〜 4-5 変数を監視してみよう
      - 第5章 どうしても解決できない時は？
      - 第6章 デバッグしやすいコードを書こう


------------


## 💡 本日の学び・気付き
### コードが動かないので帰れません！新人プログラマーのためのエラーが怖くなくなる本
#### 第4章 ツールを活用してデバッグを楽にしよう
##### 4-3 いろいろなステップ実行
- ステップ実行には3つの種類がある。
###### 1. ステップイン（Step In）
ステップインは、最もシンプルなステップ実行で、これから実行する全てのコードを1行ずつ実行していく。慎重に進めたいときに使用するが、全ての処理をステップ実行すると時間がかかってしまうため、注意が必要。

###### 2. ステップオーバー（Step Over）
ステップオーバーは、現在の行のコードを実行し、次の行に進む。関数呼び出しがあった場合、関数の中には入らずに、関数呼び出しを実行して次の行に進む。ステップオーバーは、コードの全体像を把握しながら、ステップバイステップで実行を進めるのに役立つ。

###### 3. ステップアウト（Step Out）
ステップアウトは、現在の関数の実行を完了し、戻り値を返したあとに、呼び出し元に戻る。関数内でデバッグを行っているときに、関数から出て呼び出し元に戻るのに役立つ。

###### 各種ステップ実行の使いどころ

| 実行方法 | 使いどころ |
|:---|:---|
| ステップイン | 全てのコードを1行ずつ丁寧に確認したい場合に使う |
| ステップオーバー | ステップインと同様に1行ずつ確認するが、関数の内部には入らないので、処理の詳細ではなく、全体の流れを確認したいときに使う |
| ステップアウト | ステップインで、デバッグが必要ない関数に入ってしまったときに、関数の外に抜け出すために使う |

##### 4-4 条件つきブレークポイント
- 多くのデバッガには**条件つきブレークポイント**と呼ばれる機能がある。これは、特定の条件になったらデバッガを起動するという機能。

###### 条件付きブレークポイントが設定できる条件
- **特定の式の結果が真値になったとき**
- **コードが指定回数実行されたとき**
- **特定の関数やメソッドが実行されたとき**
- **変数が指定の値になったとき**
- **例外やエラーが発生したとき**

##### 4-5 変数を監視してみよう
- デバッガによっては**変数を監視する機能**を持っているものもある。この機能を使えば、処理中の変数の中身を確認したい場合に、ブレークポイントを設定して都度確認する必要がなくなり、実行中に変数の変化を確認することができる。

#### 第5章 どうしても解決できないときは？
##### 5-1 プログラマーのための情報収集テクニック
- Google 検索には、**検索するテキストをダブルクォーテーションで囲む**と、そのテキストと一言一句同じテキストを含んだ記事が探せる「**完全一致検索**」の機能がある。エラーの文章と完全一致したページのみに絞って検索したい場合は**検索テキストをダブルクォーテーションで囲むようにすること。**
- エラーに含まれる**具体的なファイル名などは検索テキストに含めない**ようにすること。
- インターネット上には英語のコンテンツの方が多いため、英語で検索したほうが、探している情報にヒットする確率が上がることがある。
- 英語が苦手でもデバッグ作業で何かを検索する際、検索テキストに使う英語はほぼ以下のパターンで収まる。〇〇には使っているライブラリ名やフレームワーク名など具体的な名前を入れる。
`〇〇 not working （もしくは 〇〇 doesn't work）`
- 「how to use」（使い方）、「how to implement」（実装方法）などは実装やデバッグの際に役立つフレーズ。また、英語が苦手な人は、翻訳サイトを使って調べたいフレーズを英語に翻訳してから検索するのもよい。
- 自分が使っているライブラリがうまく動かないときに、該当のコードを GitHub で検索すると、同じライブラリを使って書かれたコードを見つけられる。
- GitHub を使った検索を効率的に進めるためには、「GitHub code search」という機能の活用がおすすめ。現段階ではベータ版だが、申し込みをすれば無料で利用できるようになる。

###### 一次情報と二次情報の違い
- **一次情報**
   - **公式の情報で精度が高い**
   - **意外な機能や仕様を知れることがある**
- **二次情報**
   - **古い情報や書き間違いもある**
   - **正しい情報や選別する必要がある**
- ライブラリやフレームワークが原因でコードが意図通りに動かせない場合は、落ち着いて公式のドキュメントを読み直してみること。**ライブラリはバージョンによって仕様が変更されていることがあるので、注意して読むようにすること。**

##### 5-2 エラーが見つからないときは？
- 不具合が起きているのにエラーが見つけられない場合、次のような状況に陥っている可能性が高い。
   - **見ている場所が違う**
   - **エラーの出力設定を確認していない**
   - **エラーを握りつぶしている**

###### 見ている場所が違う
- 現代のソフトウェア開発はとても複雑になっている。フロントエンド、サーバーサイド、データベース、ウェブサーバーなど、さまざまな言語やツールが合わさって1つのシステムが形作られている。つまずいている場所がわからなくなってしまったときは、まずは**システムの登場人物を確認する**ことが大切。
- **フロントエンドのエラーはブラウザのデベロッパーツールに表示**され、**バックエンドのエラーはターミナルに表示**される。
- 目の前にある場所だけを探していてもエラーを見つけられないときは、視野を広げて、システムの登場人物を整理すること。

###### エラーの出力設定を確認していない
- 多くのツールでは、エラーの出力先を任意の場所に設定することができる。例えば、ターミナルに表示させることもできれば、テキストファイルに書き込ませることもできる。

###### エラーを握りつぶしている
- 「エラーを握りつぶす」とは、**不具合があってもエラーを表示させず、処理を継続させてしまう**プログラムの状況を指す。

##### 5-3 不具合が再現できないときは？
- 本番環境でアプリケーションを運用していると、ユーザーから不具合に関する問い合わせをもらうことがある。このとき、まずは**不具合が再現するかどうかを確認する。**もし再現できるならば、通常のデバッグ作業に進める。しかし、再現ができないケースに遭遇することもある。

###### 不具合に関する集めるべき情報
- **ユーザーの操作環境（OS やブラウザの種類・バージョン、回線状況）**
- **不具合が発生した日時**
- **該当日時にエラーログが記録されているか**
- **ログインなどユーザー固有のデータや処理が存在するか**

##### 5-4 本番環境のエラー収集方法
- 本番環境では開発環境と異なり、エラーに関する情報の出力先などを適切に設定しなければならない。
エラーに関する情報が集まったファイルのことをエラーログと呼ぶ。
- **エラートラッキングツール**：エラーログを容易に収集できるサービス（ツール）。
- 代表的なエラートラッキングツール
   - **Sentry**
   - **Rollbar**
- **ログ**：システムの操作記録やイベントの発生などを記録したデータのこと。ログそのものは、エラーに限らず正常な操作も含んだ履歴データで、それに対して、エラーに関するログのことを「**エラーログ**」と呼ぶ。
- 代表的なログ収集ツール
   - **Logflare**
   - **Papertrail**
   - **Logtail**
   - **Datadog**

#### 第6章 デバッグしやすいコードを書こう
##### 6-1 再代入は控えよう
- 再代入：一度定義した変数に再び値を代入して変数の中身を書き換えること。**再代入は時にコードを読みづらいものにしてしまう**ため注意が必要。
- 再代入を遣わすに書き換えるには、**扱うデータが変わるたびに新しい変数を用意すればよい。**
- 再代入をしないとデバッグもしやすくなる。

##### 6-2 スコープは可能な限り狭めよう
- **スコープ**：**変数や関数の有効範囲**のこと。
- スコープを不必要に広げてしまうと、コードの読むべき範囲が広がりデバッグが大変になる。

###### スコープが広い場合のデメリット
- **デバッグ時に読むべきコードが増える**
- **パフォーマンスが悪くなる**
- **変更しづらくなる**

##### 6-3 単一責任の原則を知ろう
- **単一責任の原則**：**クラスや関数などのコードが持つ責務は1つにするべき**というルールのこと。つまり、「異なる役割を同時に持たない」ということ。

##### 6-4 純粋関数を利用しよう
- プログラムは「関数をどのように書くか」でその読みやすさは大きく変わる。
- 関数の中で、ある条件を満たしたものを「**純粋関数**」と呼ぶ。純粋関数はいくつかのメリットを持っているが、特に「**読みやすい**」「**デバッグしやすい**」という優れた特徴を持っている。
- 純粋関数とは、関数の中で以下の2つの条件を満たしたもの。
1. **引数が同じであれば、同じ戻り値となる**
2. **副作用がない**
      - **副作用**：プログラミングの関数における副作用とは「**関数外部の状態を変更すること**」。
- とはいえ、**全ての関数を純粋関数で書くことは現実的ではないし、また無理やり純粋関数にすべきということではない。**プログラムは、関数の外部の状態を変更する必要もある。また、**オブジェクト指向の言語では、純粋関数を作りにくい性質**もある。
###### 純粋関数とそうでない関数の比較
- 純粋関数は、そうでない関数と比較して「**読みやすい**」「**デバッグがしやすい**」という特徴がある。
- 純粋関数は関数外部との関わりがなく、関数内部だけを読めばどのような処理を行なっているか把握できるため圧倒的に読みやすい。
- そうでない関数は、処理を追う際に関数の外側まで意識して読まなければならない。

##### 6-5 型を意識してコードを書こう
- 型の情報を伝えるアプローチの1つとして「**型をコメントに書いておく**」という方法がある。これは、関数が複雑になった場合は、コメントを読むだけで処理の意図がわかるようになり、とても有用。
- プログラミング言語の機能を用いて型情報を扱うこともできる。現行バージョンのPHP、Python、Ruby には型情報を記述する方法がサポートされている。型を曖昧にせず、しっかりと意識することで不具合の起きにくいコードが書けるようになる。

##### 6-6 デバッグを助けるテストコード
- **テストコード**：ソフトウェアの品質を確保するために、コードの動作をテストするためのコード。テストコードを使えば、書いているコードが意図した通りに動くのかを自動で検証できる。
- デバッグを助けるテストコードには、2つの要素がある。
1. **デバッグ中の動作確認を自動化できる**
2. **不具合の修正が他のコードに影響を与えないか確認できる**
- 不具合が起きたときは、次のような順序で対応を行うのが理想的。
1. **どのような不具合か確認する**
2. **不具合を再現するテストコードを書く**
3. **テストコードをパスするようにコードを修正する**
4. **他のテストも実行し、修正による影響がないことを確認する**
- デバッグと修正作業は、何回も同じような作業を繰り返す性質がある。手作業で何度も確認するのは時間の無駄で、特に不具合対応しているときは焦っているためミスすることもある。**テストコードを書いて活用することでデバッグを効率的に進めること。**


------------


## ⏭️ 次回
### プラクティス『プログラムの修正』
- ソースコードを修正
   - debug.gem を用いてデバッグを行う
   - コードの修正 


------------


## ✍🏻 感想
### 🧑🏻‍💻💭 皆さんのようにプログラミングを楽しめるようになりたい！
書籍『コードが動かないので帰れません！新人プログラマーのためのエラーが怖くなくなる本』のエピローグから一部引用：

> 不具合に遭遇したときに「嫌だなぁ」と感じるのではなく「おっ、今回はどんな発見があるのだろうか？」「どのようにデバッグをしようか？」「どこに改善の余地があるだろうか？」とワクワクした気持ちになれれば、プログラミングはより楽しいものになるはずです。

私も同じ気持ちになってプログラミングを楽しめるようになることを目標に、今は勉強あるのみです！


------------


## ⏰ 学習時間
- Today:&nbsp;&nbsp; 6 hours 18 min
- Total: 706 hours 16 min
