# 2025/11/16(日)
## 📚 プラクティス『lsコマンドを作る1』

<details><summary>🎯 学習の狙い</summary>

- 標準出力について学ぶ
- 標準ライブラリの使い方を学ぶ
- Enumeratorには、each以外に便利なメソッドがあることを学ぶ
- RailsじゃないRubyプログラミングを学ぶ
- メソッド分割を学ぶ
- わかりやすい変数名メソッド名を学ぶ
- 大きな問題を分割する力を学ぶ
</details>

<details><summary>📌 要件（Docs：lsコマンドを作る 参照）</summary>

- [x] オプション（`-a`や`-r`など）を付けず、且つ引数（フォルダのパス）も指定せずに実行する
- [x] そのまま実行すると、今いるフォルダ（カレントディレクトリ）の中身を表示する
- [x] `gem`は使わずに Ruby の標準ライブラリだけで作ること
- [ ] 完成したコードは GitHub の Pull Request として提出すること
- [ ] `rubocop-fjord`でデバッグを実行し、全てパスさせること
- [x] 2つ以上のメソッドを自分で定義すること
- [x] 表示は横に最大3列になるようにレイアウトすること
  - 3, 6, 9, 12のように3の倍数の件数だけでなく、最後の列に空欄ができるケースの結果も載せる
  - 「3列から5列に仕様変更してください」または「3列から100列に変えてください」とあとから言われても必要最小限の変更で対応できるようなロジックにしておくこと
</details>

<details><summary>📑 全体の設計 （⚠️ ネタバレに注意）</summary>

### 1. ファイルの取得（ソート含む）
- 入力：検索パターン
- 処理：`Dir.glob`で指定パターンに合うファイルやディレクトリを取得し、並び替え
- 出力：ファイル・ディレクトリ一覧（配列でまとめたもの）

### 2. 行数の計算
- 入力：ファイル（要素）を配列でまとめたものと列数
- 処理：`行数 = (要素の数 ÷ 列数).ceil`で余りを切り上げる
- 出力：行数（Integer = 整数）

### 3. 要素一つ一つを縦に配置
- 入力：ファイル（要素）を配列でまとめたもの、行数・列数
- 処理：①行ごとの配列を作る　②各列に要素を縦に配置　③インデックス計算：`index = row + column * rows`
- 出力：縦詰めに並んだ配列

### 4. 配置を整える
- 入力：縦詰めに並んだ要素
- 処理：タブ文字（`join("\t")`）を使用して見やすく整える
- 出力：整えられた文字列
</details>

<details><summary> 🧩 タスクばらし ※ 随時、追加・変更あり</summary>

- [x] タスク1：開発の準備（テストフォルダ）
  - [x] ToDo：作業用フォルダを用意し、その中にダミーファイルをいくつか置く
  - [x] 作業時間： 30分
  - [x] 終了条件：テストフォルダにファイルがある

- [x] タスク2：全体設計
  - [x] ToDo：「主要な処理」を列挙する
  - [x] 作業時間：60分
  - [x] 終了条件：主要な処理（要件）を一つずつ列挙すること

- [x] タスク3：ファイルの取得とソート（並び替え）
  - [x] ToDo：`.`や`..`から始まるファイルや隠しファイルは出力させないようにする
  - [x] 作業時間：60分
  - [x] 終了条件：期待している並び順になっていること

- [x] タスク4：行数・列数のロジックを考える（余りの切り上げを用いる）
  - [x] ToDo：先ずは列数を3列に決め、行数が切り上げになること
  - [x] 作業時間：60分
  - [x] 終了条件：列数や要素の数を変更しても期待どおりになっていること

- [x] タスク5：縦詰めにロジックをメソッド化
  - [x] ToDo：縦詰めに変換するメソッドを実装し、期待どおりなっていること
  - [x] 作業時間：90分
  - [x] 終了条件：縦詰めの出力が期待どおりであること

- [x] タスク6：列幅を揃える
  - [x] ToDo：タブ文字を用いて文字列同志の幅を整える
  - [x] 作業時間：90分
  - [x] 終了条件：実際に見て読みやすくなっていること

- [x] タスク7：2つ以上のメソッドを自分で定義する
  - [x] ToDo：「何をやるか」に名前を付けて、後で呼び出せるようにする
  - [x] 作業時間：240分
  - [x] 終了条件：メソッドを2つ定義すること

- [ ] タスク8：rubocop-fjord に通す
  - [ ] ToDo：rubocop-fjord 通して出力されたエラーを一つずつ直していく
  - [ ] 作業時間：数時間？エラーの内容によりけり
  - [ ] 終了条件：rubocop-fjord の警告・エラーが発生していないこと

- [ ] タスク9：提出
  - [ ] ToDo：作成した lsコマンドを Pull Request として提出
  - [ ] ToDo：提出物にlsコマンドの実行結果とOS標準（macなど自分の使ってるOS）のlsコマンドをのスクリーンショットを併記して貼る
  - [ ] ToDo：rubocop-fjord のチェックが全てパスした画面をスクショして添付
  - [ ] 作業時間：60分
  - [ ] 終了条件：メンターさんに課題を提出すること
</details>


---


## 🧑🏻‍💻 本日の取り組み
### プラクティス『lsコマンドを作る1』🛠️💻
- メソッド化の作業


---


## ⏭️ 次回
### プラクティス『lsコマンドを作る1』🛠️💻
- rubocop-fjord に通す
- メンターさんに課題提出


---


## 💡 本日の学び・気付き
### メソッド化
lsコマンドのプログラムで役割ごとのまとまりをメソッド化して整理する作業を進めた。
<details><summary> ⚠️ ネタバレに注意</summary>

### 表示幅の計算
#### 元のコード
```ruby
max_length = files.map(&:length).max + 1
```
- 入力：`files`（ファイル名の配列）。
- 処理：各ファイル名の文字数を調べて、最大値を求め、更に`1`を足す。
- 出力（戻り値）：一列分の幅（整数）。
- 目的：列を揃える際の幅を決める（整形）。

#### メソッド化したコード
```ruby
def max_length(files)
  files.map(&:length).max + 1
end
```
- メソッド名は「何を求めるか」を示す。
- 引数は必要なものだけ（ここでは`files`）。
- 戻り値は計算結果だけ。

### 行を組み立てて出力するループ
#### 元のコード
```ruby
rows.times do |row|
  line = ""  

  columns.times do |column|
    index = row + column * rows   
    name = files[index] || ""     
    line += name.ljust(max_length) 
  end

  puts line  
end
```
- 入力：`files`（ファイル名の配列）、`rows`（行数）、`columns`（列数）、`max_length`（一列分の幅）。
- 処理：
  - 1. 行ごとに繰り返し
  - 2. 各列のファイル名を取得
  - 3. 空文字で補完
  - 4. 左寄せで幅を揃えて行を作成
  - 5. 画面に出力

#### メソッド化したコード
```ruby
def build_line(files, row, rows, columns, max_length)
  line = ""

  columns.times do |column|
    index = row + column * rows
    name = files[index]  || ""
    line += name.ljust(max_length)
  end

  line
end

def print_rows(files, rows, columns, max_length)
  rows.times do |row|
    line = build_line(files, row, rows, columns, max_length)
    puts line
  end
end
```
- 上からコードを読んだときに以下の順番にすると読みやすいのでは？と考えた。
  - `build_line` → 「一行を作る」
  - `print_rows` → 「`build_line`を元に全行を出力する」

### メソッドの呼び出し
```ruby
print_rows(files, rows, columns, max_length(files))
```
- 役割：`files`に入っているファイル名の配列を列揃えで見えやすく画面に表示する処理を呼び出している。これまで計算してきた「行数」「列数」「列幅」を使用して、初めて**ファイル一覧を画面に整列された状態**で表示できる。
- 引数の意味
  - 1. `files`
    - ファイル名の配列。
    - 入力として渡すことで、どのファイルを表示するかを指定できる。
  - 2. `rows`
    - 行数。
    - ファイルを縦方向に並べるときに**何行で分けるのか**を指定する。
  - 3. `columns`
    - 列数。
    - 一行に何列文のファイル名を表示するかを指定する。
  - 4. `max_length(files)`
    - 列幅（一列分の幅）
    - ファイル名を左寄せで揃える際に**必要な幅**を計算して渡す。
    - メソッド`max_length(files)`を呼び出すことで、長さが変わっても対応できる。

### 完成したコード（提出予定）
```ruby
#!/usr/bin/env ruby
# frozen_string_literal: true

files = Dir.glob('*').sort
columns = 3
rows = (files.size.to_f / columns).ceil

def max_length(files)
  files.map(&:length).max + 1
end

def build_line(files, row, rows, columns, max_length)
  line = ""

  columns.times do |column|
    index = row + column * rows
    name = files[index]  || ""
    line += name.ljust(max_length)
  end

  line
end

def print_rows(files, rows, columns, max_length)
  rows.times do |row|
    line = build_line(files, row, rows, columns, max_length)
    puts line
  end
end

print_rows(files, rows, columns, max_length(files))
```
</details>

### 自分が苦手にしていたメソッドに関するポイント
#### 1. メソッド化の考え方
- メソッドは「何を入力として受け取り、何を返すか」で決まる
  - 入力 = 引数（処理に必要なものだけ）。
  - 出力 = 戻り値（処理の結果だけ）。
  - その他の処理はメソッドの中にまとめて良い。
- ポイント：何を渡して何を返すのかを明確にすると、メソッド化がしやすくなる。

#### 2. どこをメソッド化するかの判断
- メソッド化した方が良いケース
  - 同じ処理を複数回使用する場合。
  - 一つのまとまった役割の処理がある場合。
- メソッド化しない方が良いケース
  - 呼び出すのが一箇所だけで、DRY原則に貢献しない場合。
  - 変数や計算が一行で簡潔な場合。

#### 3. メソッド化で混乱したポイント
- 引数と戻り値の整理が難しい
  - 例）`max_length`の計算
    - 引数：`files`（配列）
    - 戻り値：列幅（整数）
- 内部で使う変数と引数の関係
  - メソッドの中で`files`などの変数を直接参照するとエラーになる。
  - 必ず**引数として渡す**必要がある。

#### 4. メソッドの分け方の理解
- 一行を作る処理と全行を出力する処理に分ける
  - `build_line` → 一行の文字列を作る。
  - `print_rows` → 全行を出力する。
- 分けることで、処理の区分がはっきりさせることができた

#### 5. 命名のポイント
- **動詞 + 名詞**で作る。
- 処理の内容が名前からイメージできると自分にも読み手にも良い！

#### 6. メソッドについての学び・気付き
- メソッド化は「分ける・整理する作業」
- 引数・戻り値を意識するとメソッドを作りやすくなる
- メソッド名を工夫すると処理の意味が伝わりやすくなる。
- まだメソッド化（特にメソッドに渡す引数）は分からないし、慣れていないけれど一つずつ理解しながら作ると少しずつ分かってくる。

**※↑私感ですので、「ここの認識は違うよ」「ここはこうするといいよ」などありましたら、ご指摘くださると助かります！**

---


## ✍🏻 感想
メソッド化できました🫠
とはいえ、本当に正しくできているかはまだ自信がありません。
日報には書いていませんが、書籍『たのしいRuby』の学習に加えて、ChatGPT で演習問題を解き続けたおかげで「このまとまりはメソッド化できそう」とか「メソッドに渡す引数はこれとこれ......」といった意識が少しだけ持てるようになりました。

コードを書けるようになるには、読み書きを積み重ねることが本当に大切だと身に染みます。HP も MP も残っていないので、`rubocop-fjord`に通す作業は次回に回します。


---


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 hours 15 min
- Total: 1409 hours 48 min
