# 2025/11/08(土)
## 📚 プラクティス『lsコマンドを作る1』

<details><summary>🎯 学習の狙い</summary>

- 標準出力について学ぶ
- 標準ライブラリの使い方を学ぶ
- Enumeratorには、each以外に便利なメソッドがあることを学ぶ
- RailsじゃないRubyプログラミングを学ぶ
- メソッド分割を学ぶ
- わかりやすい変数名メソッド名を学ぶ
- 大きな問題を分割する力を学ぶ
</details>

<details><summary>📌 要件（Docs：lsコマンドを作る 参照）</summary>

- [ ] オプション（`-a`や`-r`など）を付けず、且つ引数（フォルダのパス）も指定せずに実行する
- [ ] そのまま実行すると、今いるフォルダ（カレントディレクトリ）の中身を表示する
- [ ] `gem`は使わずに Ruby の標準ライブラリだけで作ること
- [ ] 完成したコードは GitHub の Pull Request として提出すること
- [ ] `rubocop-fjord`でデバッグを実行し、全てパスさせること
- [ ] 2つ以上のメソッドを自分で定義すること
- [ ] 表示は横に最大3列になるようにレイアウトすること
  - 3, 6, 9, 12のように3の倍数の件数だけでなく、最後の列に空欄ができるケースの結果も載せる
  - 「3列から5列に仕様変更してください」または「3列から100列に変えてください」とあとから言われても必要最小限の変更で対応できるようなロジックにしておくこと
</details>

<details><summary>📑 全体の設計 （⚠️ ネタバレに注意）</summary>

### 1. ファイルの取得（ソート含む）
- 入力：検索パターン
- 処理：`Dir.glob`で指定パターンに合うファイルやディレクトリを取得し、並び替え
- 出力：ファイル・ディレクトリ一覧（配列でまとめたもの）

### 2. 行数の計算
- 入力：ファイル（要素）を配列でまとめたものと列数
- 処理：`行数 = (要素の数 ÷ 列数).ceil`で余りを切り上げる
- 出力：行数（Integer = 整数）

### 3. 要素一つ一つを縦に配置
- 入力：ファイル（要素）を配列でまとめたもの、行数・列数
- 処理：①行ごとの配列を作る　②各列に要素を縦に配置　③インデックス計算：`index = row + column * rows`
- 出力：縦詰めに並んだ配列

### 4. 配置を整える
- 入力：縦詰めに並んだ要素
- 処理：タブ文字（`join("\t")`）を使用して見やすく整える
- 出力：整えられた文字列
</details>

<details><summary> 🧩 タスクばらし ※ 随時、追加・変更あり</summary>

- [x] タスク1：開発の準備（テストフォルダ）
  - [x] ToDo：作業用フォルダを用意し、その中にダミーファイルをいくつか置く
  - [x] 作業時間： 30分
  - [x] 終了条件：テストフォルダにファイルがある

- [x] タスク2：全体設計
  - [x] ToDo：「主要な処理」を列挙する
  - [x] 作業時間：60分
  - [x] 終了条件：主要な処理（要件）を一つずつ列挙すること

- [x] タスク3：ファイルの取得とソート（並び替え）
  - [x] ToDo：`.`や`..`から始まるファイルや隠しファイルは出力させないようにする
  - [x] 作業時間：60分
  - [x] 終了条件：期待している並び順になっていること

- [x] タスク4：行数・列数のロジックを考える（余りの切り上げを用いる）
  - [x] ToDo：先ずは列数を3列に決め、行数が切り上げになること
  - [x] 作業時間：60分
  - [x] 終了条件：列数や要素の数を変更しても期待どおりになっていること

- [x] タスク5：縦詰めにロジックをメソッド化
  - [x] ToDo：縦詰めに変換するメソッドを実装し、期待どおりなっていること
  - [x] 作業時間：90分
  - [x] 終了条件：縦詰めの出力が期待どおりであること

- [x] タスク6：列幅を揃える
  - [x] ToDo：タブ文字を用いて文字列同志の幅を整える
  - [x] 作業時間：90分
  - [x] 終了条件：実際に見て読みやすくなっていること

- [ ] タスク7：2つ以上のメソッドを自分で定義する
  - [ ] ToDo：「何をやるか」に名前を付けて、後で呼び出せるようにする
  - [ ] 作業時間：240分
  - [ ] 終了条件：メソッドを2つ定義すること

- [ ] タスク8：rubocop-fjord に通す
  - [ ] ToDo：rubocop-fjord 通して出力されたエラーを一つずつ直していく
  - [ ] 作業時間：数時間？エラーの内容によりけり
  - [ ] 終了条件：rubocop-fjord の警告・エラーが発生していないこと

- [ ] タスク9：提出
  - [ ] ToDo：作成した lsコマンドを Pull Request として提出
  - [ ] ToDo：提出物にlsコマンドの実行結果とOS標準（macなど自分の使ってるOS）のlsコマンドをのスクリーンショットを併記して貼る
  - [ ] ToDo：rubocop-fjord のチェックが全てパスした画面をスクショして添付
  - [ ] 作業時間：60分
  - [ ] 終了条件：メンターさんに課題を提出すること
</details>


---


## 🧑🏻‍💻 本日の取り組み
### プラクティス『lsコマンドを作る1』🛠️💻
- これまでを振り返る


---


## ⏭️ 次回
### プラクティス『lsコマンドを作る1』🛠️💻
- 自分のコードを読んでどの部分をメソッドにできそうか印をつける


---


## 💡 本日の学び・気付き
最後にコードを書いてから時間が経ってしまったので振り返る。
<details><summary> ⚠️ ネタバレに注意</summary>

```ruby
files = Dir.glob('*').sort

columns = 3

rows = (files.size.to_f / columns).ceil

width = files.map(&:length).max
padding = width + 1

rows.times do |row|
  line = []
  columns.times do |column|
    index = row + column * rows
    if index < files.size
      line << files[index].ljust(padding)
    else
      line << ''.ljust(padding)
    end
  end
  puts line.join
end
```
### ①ファイル一覧を取得する
```ruby
files = dir.glob('*').sort
```
#### ✅ ここでの処理
- `Dir.glob('*')`は、可憐度ディレクトリのファイル名一覧を配列で取得する。
  - 例：`["Gemfile", "LICENSE", "README.md", "lib", "main.rb", "test"]`
- `sort`は、ファイル名をアルファベット順に並べ替えるメソッド。

#### 📍 ポイント
- `Dir.glob`の`'*'`は「全てのファイル・ディレクトリ」を意味する。

### ②列数を決める
```ruby
columns = 3
```
#### ✅ ここでの処理
- 出力を 3列表示にしたいという指定。

#### 📍 ポイント
- `columns`の値を変えれば、列数を自由に変えられる。

### ③行数を計算する
```ruby
rows = (files.size.to_f / columns).ceil
```
#### ✅ ここでの処理
- ファイルの総数を列数で割り、行数を求めている。
- `ceil`は「小数点を切り上げる」メソッド。
  - 例：ファイル数 = 10、列数 = 3 の場合 → `10 / 3 = 3.33...` → `ceil`メソッドで 4行になる。

### ④幅(スペースの取り方）を計算する
```ruby
width = files.map(&: length).max
padding = width + 1
```
#### ✅ ここでの処理
- 各ファイル名の文字数を調べて、一番長いものの長さを取得。
- それに 1文字分の空白を足して「カラムの幅（間隔）」を決める。

#### 📍 ポイント
たとえば、最長ファイル名が`README.md`（9文字）なら`width = 9`, `padding = 10`にして、見やすい間隔をとる。

### ⑤ファイルを縦方向に詰めて並べる
```ruby
rows.times do |row|
  line = []
  columns.times do |column|
    index = row + column * rows
    if index < files.size
      line << files[index].ljust(padding)
    else
      line << ''.ljust(padding)
    end
  end
  puts line.join
end
```
#### ✅ 処理の流れ
1. 外側のループ（`rows.times`）
→ 行ごとに 1行ずつ出力していく。
2. 内側のループ（`columns.times`）
→ 各列にファイル名を入れていく。
3. `index`の計算
```ruby
index = row + column * rows
```
- これが「縦に並べる」ための重要な計算（私感）。
- たとえば、行が 4行・列が 3列の場合：

|列   |インデックス（row + column * rows）   |
|:---:|:---:|
|0   |0, 1, 2, 3   |
|1   |4, 5, 6, 7   |
|2   |8, 9, 10, 11   |

これにより、上から下へ縦にファイルが詰められる。

4. `if index < files.size`
→ ファイル数を超えた場合は空白を入れてズレを防ぐ。

5. `ljust(padding)`
→ 左寄せで文字を整形し、列の幅を一定にする。

6. `line.join`
→ 各列を繋げて 1行の文字列にまとめ、`puts`で表示。

例でイメージ
- ファイル一覧が`["a.rb", "b.rb", "c.rb", "d.rb", "e.rb", "f.rb", "g.rb"]`で列数が 3列の場合：

|行   |index計算   |lineの内容   |
|:---:|:---:|:---:|
|0   |0, 3, 6   |a.rb, d.rb, g.rb   |
|1   |1, 4, 7   |b.rb, e.rb ー（なし）   |
|2   |2, 5, 8   |c.rb, f.rb ー（なし）   |

結果：
```shell
a.rb   d.rb   g.rb
b.rb   e.rb
c.rb   f.rb
```

### まとめ：このコードの構造を一言で言うと
|ステップ   |内容   |
|---|---|
|①   |ファイル一覧を取得（Dir.glob('*').sort）   |
|②   |列数を決める（columns = 3）   |
|③   |行数を計算する（rows = (files.size / columns).ceil）   |
|④   |幅を決める（width = files.map(&: length).max）   |
|⑤   |行ごとに縦詰めして整形して出力する（index = row + column * rows）   |

</details>



---


## ✍🏻 感想
久し振りの『lsコマンドを作る1』。最後にコードを書いてから時間が経ってしまったので、振り返る一日でした。時間はかかりましたが、「なぜ自分がこのコードを書いたのか」を再確認できたのは大きな収穫です。

次回はメソッド化を意識しながら、自分の書いたコードの整理に取り組みたいと思います。少しずつでも確実に前へ進めていきたいです。


---


### ⏰ 学習時間
- Today:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 hours 25 min
- Total: 1392 hours 31 min
